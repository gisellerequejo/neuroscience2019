self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.CalendarModuleLazy.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[154],{13770:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r(2),c=r(6686),o=r(74),u=r(543),i=r(737),d=r(6),s=r(1776),l=r(326),f=r(2326),v=(Object(a.orchestrator)(f.a,function(e){return n.__awaiter(void 0,void 0,void 0,function(){var t,r,a,f;return n.__generator(this,function(n){switch(n.label){case 0:return t=e.event,r=e.entrySource,a=e.eventScope,f=e.anchor,Object(d.e)("rp-addins")?[4,u.G.import()]:[3,2];case 1:if(n.sent()())return i.d.importAndExecute(t,0,!1,s.c,l.c,null),[2];n.label=2;case 2:return c.a.importAndExecute(f||o.g.selectedItemCSSSelector,r,"Surface",t,a),[2]}})})}),r(61)),b=r(18);Object(a.orchestrator)(v.I,function(e){var t=e.endComposeData,r=t.eventCompletionType,n=t.quickComposeEntrySource,a=t.isAllDay,c=t.isNewEvent,u=t.formType,i=t.fullComposeEntrySource,d=t.isGroupMailbox,s=Object(o.f)().dateRangeType;Object(b.o)("calendarComposeSessionEnded",{eventCompletionType:r,quickComposeEntrySource:n,surfaceDateRangeType:s,isNewEvent:c,isAllDay:a,formType:u,fullComposeEntrySource:i,isGroupMailbox:d})});var p=r(34),_=r(1173),m=r(820),j=(Object(a.orchestrator)(m.e,function(e){1!==e.reminderType&&4!==e.reminderType||_.b.importAndExecute({Id:e.itemId,mailboxInfo:Object(p.e)()},"ReminderClicked",!1,!0)}),r(7373),r(941)),O=r(2411),y=r(265),S=r(182);Object(a.orchestrator)(O.c,function(e){var t=e.calendar,r=Object(y.a)(S.b.selectedCalendars,function(e){return e.id.id==t.id.id&&e.displayName==t.displayName});Object(b.q)().addCustomData({calendarSelected:!r}),r?Object(j.g)(t):Object(j.e)(t)});var C=r(2135),h=r(44),g=r(5),I=r(36),w=r(2188);Object(a.orchestrator)(w.a,function(e){var t=null;if(e.surfaceStore.dateRangeType===I.a.Month&&(t={Start:Object(C.a)(e.surfaceStore.selectedDate),IsAllDayEvent:!1}),Object(h.a)())Object(f.a)(t,e.entrySource,0,e.event.target);else{var r=e.surfaceStore.dateRange.start,n=e.surfaceStore.dateRange.end;Object(g.Cb)(r,n)&&(t={Start:Object(C.a)(r),IsAllDayEvent:!1}),i.d.importAndExecute(t,0,!1,e.entrySource,l.c,null)}});var R=r(6646),q=r(4),x=r(169),E=r(154),k=r(1217),M=r(2722),D=r(2189);function P(e,t){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(r){switch(r.label){case 0:return[4,Object(k.a)(e,void 0,t)];case 1:return[2,r.sent()]}})})}Object(a.orchestrator)(D.a,function(e){return n.__awaiter(void 0,void 0,void 0,function(){var t,r,a,c;return n.__generator(this,function(n){switch(n.label){case 0:return t=Object(x.i)(e.surfaceStore.dateRange,e.surfaceStore.dateRangeType,e.surfaceStore.userOptions.weekStartDay,!0),r=1==S.b.selectedCalendars.length?S.b.selectedCalendars[0].displayName:Object(q.a)(R.a),a=Object(E.d)().getLockId(),[4,P(t,a)];case 1:return c=n.sent(),[4,M.d.import()];case 2:return n.sent()(c,r,a,e.surfaceStore.selectedDate,e.surfaceStore.dateRangeType),[2]}})})});var T=r(3943);Object(a.orchestrator)(T.h,function(e){var t=e.calendar;Object(y.a)(Object(S.g)(),function(e){return e.id.id==t.id.id})&&Object(j.g)(t)});var A=r(1265);Object(a.orchestrator)(A.h,function(e){return n.__awaiter(void 0,void 0,void 0,function(){var t,r;return n.__generator(this,function(a){switch(a.label){case 0:return t=n.__read(S.b.calendars.filter(function(t){return t.calculatedFolderId===e.parentFolderId}),1),(r=t[0])?[4,Object(j.e)(r)]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}})})})},4121:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);t.default=function(e){return n.__assign({__type:"FolderChange:#Exchange"},e)}},4485:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);t.default=function(e){return n.__assign({__type:"CalendarFolder:#Exchange"},e)}},5154:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(56),a=r(219);t.default=function(e,t){return void 0===e.itemId||e.itemId.__type||(e.itemId=a.default(e.itemId)),n.makeServiceRequest("RenameCalendar",e,t)}},5155:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(56),a=r(219);t.default=function(e,t){return void 0===e.groupId||e.groupId.__type||(e.groupId=a.default(e.groupId)),n.makeServiceRequest("RenameCalendarGroup",e,t)}},5156:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(56);t.default=function(e,t){return n.makeServiceRequest("CreateCalendar",e,t)}},5157:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(56);t.default=function(e,t){return n.makeServiceRequest("CreateCalendarGroup",e,t)}},5158:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(56),a=r(219);t.default=function(e,t){return void 0===e.itemId||e.itemId.__type||(e.itemId=a.default(e.itemId)),n.makeServiceRequest("DeleteCalendar",e,t)}},5159:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(56);t.default=function(e,t){return n.makeServiceRequest("DeleteCalendarGroup",e,t)}},5160:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(56),a=r(219);t.default=function(e,t){return void 0===e.itemId||e.itemId.__type||(e.itemId=a.default(e.itemId)),n.makeServiceRequest("SetCalendarColor",e,t)}},5163:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(56),a=r(219);t.default=function(e,t){return void 0===e.itemId||e.itemId.__type||(e.itemId=a.default(e.itemId)),n.makeServiceRequest("SetCalendarHexColor",e,t)}},6646:function(e){e.exports={a:"QSb"}},6686:function(e,t,r){"use strict";r.d(t,"a",function(){return c});var n=r(3),a=new n.c(function(){return Promise.all([r.e(15),r.e(18),r.e(25),r.e(67),r.e(372)]).then(r.bind(null,3033))}),c=new n.a(a,function(e){return e.showQuickCompose})},7373:function(e,t,r){"use strict";var n=r(0),a=r(5161),c=r(1764),o=r(4),u=r(41),i=r(686),d=r(34),s=r(5162),l=r(11),f=r(182),v=r(3943),b=r(2);Object(b.orchestrator)(f.q,function(e){return n.__awaiter(void 0,void 0,void 0,function(){var t,r,c,s;return n.__generator(this,function(n){switch(n.label){case 0:return t=e.calendar,r=e.newColor,c=Object(u.j)(t),s=t.colorScheme,-1==c.CalendarColor&&(s=null),t.id.mailboxInfo.type!=d.a.GroupMailbox?[3,1]:(Object(v.q)(t,r),[3,3]);case 1:return i.e.import().then(function(e){e("setCalendarHexColor","Surface",Object(o.b)(Object(o.a)(a.a),t.displayName),{icon:"Save"})}),[4,Object(v.g)(p(t,r),_(t,s,r))];case 2:n.sent(),n.label=3;case 3:return[2]}})})});function p(e,t){var r=this;return function(){return n.__awaiter(r,void 0,void 0,function(){var r;return n.__generator(this,function(n){switch(n.label){case 0:return Object(v.q)(e,t),[4,Object(v.o)(e.id,Object(u.t)(e.id.id),t)];case 1:return r=n.sent(),r.WasSuccessful&&l.d.info("[setCalendarHexColor] Successfully set new calendar color, calendar: "+e.displayName+", color: "+t),[2,r]}})})}}function _(e,t,r){return function(){var n=t?t.calPrimary:"";Object(v.q)(e,n),Object(v.p)("setCalendarHexColor",Object(o.b)(Object(o.a)(s.a),e.displayName),"Error",Object(o.a)(c.a),function(){return Object(f.q)(e,r)})}}}},0,[15,18,25,67,372,6,7,9,14,142,157,240,2,3,8,41,162,4,10,571,399,79,524,49,160,0,1,526,178,45,278,146,514,105,557,335,24,116,173,234,495]]);
//# sourceMappingURL=owa.CalendarModuleLazy.js.map
self.scriptsLoaded['owa.CalendarModuleLazy.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.CalendarModuleLazy.js'] = (new Date()).getTime();