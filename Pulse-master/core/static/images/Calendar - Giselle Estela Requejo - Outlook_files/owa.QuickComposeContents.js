self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.QuickComposeContents.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[371],{1058:function(e,t,a){"use strict";a.d(t,"a",function(){return i});var n=a(2),r=a(7),i=Object(n.createStore)("optionsViewState",{isFullOptionsShown:!1,isSaving:!1,currentCategoryKey:null,currentSubCategoryKey:null,subCategoryLoadState:new r.ObservableMap,currentOptionKey:null,allowedOptions:[]})},1097:function(e,t,a){"use strict";a.d(t,"a",function(){return r});var n=a(2),r=Object(n.createStore)("allowedOptions",{allowedOptions:[]})},1098:function(e,t,a){"use strict";var n=a(3),r=a(1097),i=a(44);function o(e){return Object(i.a)()||e.every(function(e){return Object(r.a)().allowedOptions.includes(e)})}a.d(t,"b",function(){return c}),a.d(t,"a",function(){return o});var l=new n.c(function(){return a.e(114).then(a.bind(null,13866))}),c=new n.a(l,function(e){return e.loadAllowedOptions})},11873:function(e){e.exports={c:"OQa",d:"PQa",b:"QQa",e:"RQa",a:"SQa"}},329:function(e,t,a){"use strict";var n=a(3),r=a(1098),i=a(22),o=a(1058);function l(){var e=Object(o.a)();return{isFullOptionsShown:e.isFullOptionsShown,currentCategoryKey:e.currentCategoryKey,currentSubCategoryKey:e.currentSubCategoryKey,currentOptionKey:e.currentOptionKey}}a.d(t,"e",function(){return s}),a.d(t,"d",function(){return u}),a.d(t,"c",function(){return d}),a.d(t,"a",function(){return m}),a.d(t,"b",function(){return l});var c=new n.c(function(){return Promise.all([a.e(5),a.e(15),a.e(40),a.e(85),a.e(344)]).then(a.bind(null,13644))}),s=new n.a(c,function(e){return e.mountAndShowFullOptions}),u=new n.b(c,function(e){return e.hideFullOptions}),d=new n.b(c,function(e){return e.confirmDirtyOptionsAndPerformAction}),m=Object(n.d)(c,function(e){return e.QuickOptions});Object(i.c)(function(){r.b.importAndExecute()})},3618:function(e,t,a){"use strict";function n(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),{content:e,isDirty:t}}a.d(t,"a",function(){return n})},3869:function(e,t,a){"use strict";var n=a(8),r=a(3926);t.a=Object(n.action)("updateContent")(function(e,t,a){e.content!=t&&(e.content=t,a||Object(r.a)(e,!0)),a&&(e.initialContent=t)})},3883:function(e,t,a){"use strict";function n(e){return e.localizedName?e.localizedName:e.name}var r=[{name:"Arial",family:"Arial,Helvetica,sans-serif"},{name:"Arial Black",family:"'Arial Black',Arial,sans-serif"},{name:"Calibri",family:"Calibri,Helvetica,sans-serif"},{name:"Calibri Light",family:"'Calibri Light','Helvetica Light',sans-serif"},{name:"Cambria",family:"Cambria,Georgia,serif"},{name:"Candara",family:"Candara,Optima,sans-serif"},{name:"Century Gothic",family:"'Century Gothic',sans-serif"},{name:"Comic Sans MS",family:"'Comic Sans MS',Chalkboard,cursive"},{name:"Consolas",family:"Consolas,Courier,monospace"},{name:"Constantia",family:"Constantia,'Hoefler Text',serif"},{name:"Corbel",family:"Corbel,Skia,sans-serif"},{name:"Courier New",family:"'Courier New',monospace"},{name:"Franklin Gothic Book",family:"'Franklin Gothic Book','Avenir Next Condensed',sans-serif"},{name:"Franklin Gothic Demi",family:"'Franklin Gothic Demi','Avenir Next Condensed Demi Bold',sans-serif"},{name:"Franklin Gothic Medium",family:"'Franklin Gothic Medium','Avenir Next Condensed Medium',sans-serif"},{name:"Garamond",family:"Garamond,Georgia,serif"},{name:"Georgia",family:"Georgia,serif"},{name:"Impact",family:"Impact,Charcoal,sans-serif"},{name:"Lucida Console",family:"'Lucida Console',Monaco,monospace"},{name:"Lucida Handwriting",family:"'Lucida Handwriting','Apple Chancery',cursive"},{name:"Lucida Sans Unicode",family:"'Lucida Sans Unicode','Lucida Grande',sans-serif"},{name:"Palatino Linotype",family:"'Palatino Linotype','Book Antiqua',Palatino,serif"},{name:"Segoe UI",family:"'Segoe UI','Helvetica Neue',sans-serif"},{name:"Sitka Heading",family:"'Sitka Heading',Cochin,serif"},{name:"Sitka Text",family:"'Sitka Text',Cochin,serif"},{name:"Tahoma",family:"Tahoma,Geneva,sans-serif"},{name:"Times",family:"Times,'Times New Roman',serif"},{name:"Times New Roman",family:"'Times New Roman',Times,serif"},{name:"Trebuchet MS",family:"'Trebuchet MS',Trebuchet,sans-serif"},{name:"TW Cen MT",family:"'TW Cen MT','Century Gothic',sans-serif"},{name:"Verdana",family:"Verdana,Geneva,sans-serif"},{name:"-",family:"-"},{name:"Microsoft YaHei",family:"'Microsoft YaHei','微软雅黑',STHeiti,sans-serif",localizedName:"微软雅黑"},{name:"SimHei",family:"SimHei,'黑体',STHeiti,sans-serif",localizedName:"黑体"},{name:"NSimSun",family:"NSimSun,'新宋体',SimSun,'宋体',SimSun-ExtB,'宋体-ExtB',STSong,serif",localizedName:"新宋体"},{name:"FangSong",family:"FangSong,'仿宋',STFangsong,serif",localizedName:"仿宋"},{name:"SimLi",family:"SimLi,'隶书','Baoli SC',serif",localizedName:"隶书"},{name:"KaiTi",family:"KaiTi,'楷体',STKaiti,serif",localizedName:"楷体"},{name:"-",family:"-"},{name:"Microsoft JhengHei",family:"'Microsoft JhengHei','微軟正黑體','Apple LiGothic',sans-serif",localizedName:"微軟正黑體"},{name:"PMingLiU",family:"PMingLiU,'新細明體',PMingLiU-ExtB,'新細明體-ExtB','Apple LiSung',serif",localizedName:"新細明體"},{name:"DFKai-SB",family:"DFKai-SB,'標楷體','BiauKai',serif",localizedName:"標楷體"},{name:"-",family:"-"},{name:"Meiryo",family:"Meiryo,'メイリオ','Hiragino Sans',sans-serif",localizedName:"メイリオ"},{name:"MS PGothic",family:"'MS PGothic','ＭＳ Ｐゴシック','MS Gothic','ＭＳ ゴシック','Hiragino Kaku Gothic ProN',sans-serif",localizedName:"ＭＳ Ｐゴシック"},{name:"MS PMincho",family:"'MS PMincho','ＭＳ Ｐ明朝','MS Mincho','ＭＳ 明朝','Hiragino Mincho ProN',serif",localizedName:"ＭＳ Ｐ明朝"},{name:"Yu Gothic",family:"'Yu Gothic','游ゴシック','YuGothic',sans-serif",localizedName:"游ゴシック"},{name:"Yu Mincho",family:"'Yu Mincho','游明朝','YuMincho',serif",localizedName:"游明朝"},{name:"-",family:"-"},{name:"Malgun Gothic",family:"'Malgun Gothic','맑은 고딕',AppleGothic,sans-serif",localizedName:"맑은 고딕"},{name:"Gulim",family:"Gulim,'굴림','Nanum Gothic',sans-serif",localizedName:"굴림"},{name:"Dotum",family:"Dotum,'돋움',AppleGothic,sans-serif",localizedName:"돋움"},{name:"Batang",family:"Batang,'바탕',AppleMyungjo,serif",localizedName:"바탕"},{name:"BatangChe",family:"BatangChe,'바탕체',AppleMyungjo,serif",localizedName:"바탕체"},{name:"Gungsuh",family:"Gungsuh,'궁서',GungSeo,serif",localizedName:"궁서"},{name:"-",family:"-"},{name:"Leelawadee UI",family:"'Leelawadee UI',Thonburi,sans-serif"},{name:"Angsana New",family:"'Angsana New','Leelawadee UI',Sathu,serif"},{name:"Cordia New",family:"'Cordia New','Leelawadee UI',Silom,sans-serif"},{name:"DaunPenh",family:"DaunPenh,'Leelawadee UI','Khmer MN',sans-serif"},{name:"-",family:"-"},{name:"Nirmala UI",family:"'Nirmala UI',sans-serif"},{name:"Gautami",family:"Gautami,'Nirmala UI','Telugu MN',sans-serif"},{name:"Iskoola Pota",family:"'Iskoola Pota','Nirmala UI','Sinhala MN',sans-serif"},{name:"Kalinga",family:"Kalinga,'Nirmala UI','Oriya MN',sans-serif"},{name:"Kartika",family:"Kartika,'Nirmala UI','Malayalam MN',sans-serif"},{name:"Latha",family:"Latha,'Nirmala UI','Tamil MN',sans-serif"},{name:"Mangal",family:"Mangal,'Nirmala UI','Devanagari Sangam MN',sans-serif"},{name:"Raavi",family:"Raavi,'Nirmala UI','Gurmukhi MN',sans-serif"},{name:"Shruti",family:"Shruti,'Nirmala UI','Gujarati Sangam MN',sans-serif"},{name:"Tunga",family:"Tunga,'Nirmala UI','Kannada MN',sans-serif"},{name:"Vrinda",family:"Vrinda,'Nirmala UI','Bangla MN',sans-serif"},{name:"-",family:"-"},{name:"Nyala",family:"Nyala,Kefa,sans-serif"},{name:"Sylfaen",family:"Sylfaen,Mshtakan,Menlo,serif"}];function i(e){for(var t=e.toUpperCase(),a=0;a<r.length;a++){var n=r[a];if(n.name.toUpperCase()==t||n.localizedName&&n.localizedName.toUpperCase()==t)return n.family}return null}var o="pt",l=[8,10,12,14,18,24,36],c=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72],s=c.map(function(e){return e.toString()});function u(e){return"number"==typeof e&&e<=7?l[e-1]:e}function d(e){var t=u(e).toString();return t?t+o:t}a.d(t,"g",function(){return n}),a.d(t,"a",function(){return r}),a.d(t,"d",function(){return i}),a.d(t,"b",function(){return c}),a.d(t,"c",function(){return s}),a.d(t,"e",function(){return u}),a.d(t,"f",function(){return d})},3926:function(e,t,a){"use strict";var n=a(8);t.a=Object(n.action)("setIsDirty")(function(e,t){e.isDirty=t})},4140:function(e,t,a){"use strict";a.d(t,"a",function(){return l}),a.d(t,"b",function(){return c});var n=a(0),r=a(10),i=a(3883),o={fontFamily:"Calibri,Arial,Helvetica,sans-serif",fontSize:"11pt",textColor:"#000000",bold:!1,italic:!1,underline:!1};function l(){var e=Object(r.a)().UserOptions;return e?c(e.ComposeFontName,e.ComposeFontSize,e.ComposeFontColor,e.ComposeFontFlags):o}function c(e,t,a,r){var l=n.__assign({},o),c=e?Object(i.d)(e):null;c&&(l.fontFamily=c);var s=t?Object(i.f)(t):null;return s&&(l.fontSize=s),a&&(l.textColor=a),r&&(l.bold=1==(1&r),l.italic=2==(2&r),l.underline=4==(4&r)),l}},4288:function(e,t,a){"use strict";var n=a(348),r=a.n(n),i=a(86),o=4.5,l="",c="color",s="bgcolor",u="data-ogsc",d="data-ogac",m="data-ogsb",f="data-ogab";function h(e,t){try{var a=r()(Object(i.h)().white),n=!1,o=window.getComputedStyle(e),h=e.style.color,g=r()(o.color||void 0),v=e.getAttribute(c);(t?h||v:!b(g,a))&&(g=p(g,a,!!t),e.style.setProperty("color",g.hex(),"important"),e.setAttribute(u,h||l),v&&(e.setAttribute(c,g.hex()),e.setAttribute(d,v)),n=!0);var y=e.style.backgroundColor,S=o.backgroundColor?r()(o.backgroundColor):r()(y||void 0),O=e.getAttribute(s);if((t?y||O:!b(S,g))&&(S=p(S,g,!!t),e.style.setProperty("background-color",S.hex(),"important"),e.setAttribute(m,y||l),O&&(e.setAttribute(s,S.hex()),e.setAttribute(f,O)),n=!0),n)return{element:e,styleColor:h,attrColor:v,styleBGColor:y,attrBGColor:O}}catch(e){}return null}function b(e,t){return e.contrast(t)>=o}function p(e,t,a){var n,o=r()(Object(i.h)().white).lab().array()[0],l=e.lab().array();if(a)n=(100-l[0])*((100-o)/100)+o;else{var c=t.lab().array()[0],s=50+o,u=(s+50)/2;n=l[0]*((100-o)/100)+o,n=c>u?((n=Math.min(n,2*u-n))-o)*(50-o)/(u-o)+o:100-(100-(n=Math.max(n,2*u-n)))*(100-s)/(100-u)}return r.a.lab(n,l[1],l[2]).rgb()}a.d(t,"a",function(){return h})},4535:function(e,t,a){"use strict";var n=a(4364),r=a.n(n),i=a(2);t.a=Object(i.mutatorAction)("Editor_Initialize_Undo_Snapshot",function(e){e.undoSnapshot=r()(1e7)})},4711:function(e,t,a){"use strict";var n=a(0),r=a(5229),i=a(4),o=a(19),l=function(e,t,a,n){var r=function(t){n&&n(t),null!=a&&e.api.triggerEvent(e,{eventType:a,rawEvent:t},!1)};return e.contentDiv.addEventListener(t,r),function(){e.contentDiv.removeEventListener(t,r)}},c=a(4140),s=a(18),u="EDITOR_PERF",d=5,m=25;var f=a(3568),h="PERF_DATA",b="TOTAL_TIME",p="_S",g="_E",v="_C";function y(e){return e instanceof f.Editor?e.getCustomData(h,S):e.api.getCustomData(e,h,S)}function S(){return{}}function O(e,t,a){var r=t.eventType,i=e.document.defaultView.performance,o=[];k(b,i,function(){!a&&e.plugins.some(function(e){return function(e,t,a,n){if(!t.onPluginEvent||!t.willHandleEventExclusively)return!1;var r,i=e.eventType;k(t.getName()+"_"+i+v,a,function(){r=t.willHandleEventExclusively(e)},n),r&&k(t.getName(),a,function(){return t.onPluginEvent(e)},n);return r}(t,e,i,o)})||e.plugins.forEach(function(e){e.onPluginEvent&&k(e.getName()+"_"+r,i,function(){return e.onPluginEvent(t)},o)})},o),function(e,t,a,r){var i,o;if(!a.getEntriesByName)return;var l=a.getEntriesByName(t),c=l?l[0]:null;if(c&&c.duration>=10){var s=y(e);try{for(var u=n.__values(r),d=u.next();!d.done;d=u.next()){var m=d.value;if(m!=t){var f=a.getEntriesByName(m),h=f&&f[0];if(h){var b=s[h.name];h.duration>1&&(b?(b.count++,b.totalTime+=h.duration):s[h.name]={count:1,totalTime:h.duration})}}}}catch(e){i={error:e}}finally{try{d&&!d.done&&(o=u.return)&&o.call(u)}finally{if(i)throw i.error}}}r.forEach(function(e){return a.clearMeasures(e)})}(e,b,i,o)}function k(e,t,a,n){if(!t.mark)return a();var r=e+p,i=e+g;t.mark(r),a(),t.mark(i);try{t.measure(e,r,i),n.push(e),t.clearMarks(r),t.clearMarks(i)}catch(e){}}var C=a(3458),w=a(3469),E=/[\s\u00A0\u200B\u3000]+([^\s\u00A0\u200B\u3000]*)$/i;function j(e){return E.exec(e)}var M=a(4288);function N(e,t){return{sourceString:e,replacementHTML:t,matchSourceCaseSensitive:!0}}var T=[N(";)","😉"),N(";-)","😉"),N(";P","😜"),N(";-P","😜"),N("<3","❤️"),N("</3","💔"),N(";*","😘"),N(";-*","😘"),N("B)","😎"),N("B-)","😎")],A=a(6),B=a(3926),x=a(3869),D=function(){function e(e,t){this.viewState=e,this.updateOnKeyPress=t}return e.prototype.getName=function(){return"ViewStateManage"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){11==e.eventType&&(this.updateOnKeyPress?this.updateContentToViewState():this.viewState.isDirty||Object(B.a)(this.viewState,!0))},e.prototype.updateContentToViewState=function(e){this.editor&&Object(x.a)(this.viewState,this.editor.getContent(),e)},e}(),P=a(2),L=a(4535),F=function(e){function t(t){var a=e.call(this)||this;return a.viewState=t,a}return n.__extends(t,e),t.prototype.getSnapshotsManager=function(){var e;return this.undoSnapshots||(this.viewState.undoSnapshot||Object(L.a)(this.viewState),this.undoSnapshots=(e=this.viewState.undoSnapshot,{canMove:function(t){return Object(C.canMoveCurrentSnapshot)(e,t)},move:function(t){return R(e,t),e.snapshots[e.currentIndex]},addSnapshot:function(t){return I(e,t)},clearRedo:function(){return _(e)}})),this.undoSnapshots},t}(f.Undo),R=Object(P.mutatorAction)("Undo_Move",function(e,t){return Object(C.moveCurrentSnapsnot)(e,t)}),I=Object(P.mutatorAction)("Undo_AddSnapshot",function(e,t){return Object(C.addSnapshot)(e,t)}),_=Object(P.mutatorAction)("Undo_ClearRedo",function(e){return Object(C.clearProceedingSnapshots)(e)});var G=a(77),U=a(1),z=a(3642),V=a(5230),H=a(5251),K=a(4989),W=a(115).bind(K),Q={fontFamily:"Segoe UI",fontSize:"14px",textColor:"#666"},Y=function(e){function ReactEditor(t){var a=e.call(this,t)||this;a.dirAttributeMutationObserver=null,a.unregisterLogOnFrameDropWhileTyping=null,a.onBlur=function(){a.updateContentToViewState(),a.props.onBlur&&a.props.onBlur()},a.cssClassCallback=function(e){var t=e.split(" ");return(t=t.filter(function(e){return a.props.cssClassesToPreserveWhenPaste.indexOf(e)>=0})).length>0?t.join(" "):null},a.keepValue=function(e){return e},a.onBrowserDirectionChange=function(e){var t=0!==e.length?e[0]:null;if(null!==t&&"attributes"===t.type){var n=t.target.getAttribute("dir");n&&"auto"!==n?"ltr"!==n&&"rtl"!==n||a.props.onDirectionChange(n):a.props.onDirectionChange(null)}else Object(s.o)("direction_change_invalid_mutation_callback",e.map(function(e){return JSON.stringify(e)}),{isCore:!0})};var n=t.viewState,o=t.updateOnKeyPress,l=t.cssClassesToPreserveWhenPaste,c=Object(i.b)(Object(i.a)(r.c),Object(G.i)()?Object(i.a)(r.a):Object(i.a)(r.b)),u={originalsrc:a.keepValue,crossorigin:a.keepValue,contenttype:a.keepValue};l&&(u.class=a.cssClassCallback);var d=Object(V.getDefaultContentEditFeatures)();return d.smartOrderedList=!0,d.mergeInNewLineWhenBackspaceOnFirstChar=!0,a.pastePlugin=new V.Paste(null,u),a.contentEditPlugin=new V.ContentEdit(d),a.hyperLinkPlugin=new V.HyperLink(function(e){return c+"\r\n"+e}),a.tableResizePlugin=new V.TableResize,a.customReplacePlugin=new V.CustomReplace(T),a.viewStateManagePlugin=new D(n,o),a}return n.__extends(ReactEditor,e),ReactEditor.prototype.componentDidMount=function(){this.editor=new f.Editor(this.editorDiv,this.getEditorOptions()),this.updateContentToViewState(!0),void 0!==this.props.onDirectionChange&&(this.dirAttributeMutationObserver=new MutationObserver(this.onBrowserDirectionChange),this.dirAttributeMutationObserver.observe(this.editorDiv,{attributes:!0,attributeFilter:["dir"]})),Object(A.e)("cmp-logOnFrameDropWhileTyping")&&(this.unregisterLogOnFrameDropWhileTyping=function(e,t){var a=u+"::typingIntervalStart::"+t,n=u+"::typingIntervalEnd::"+t,r=u+"::typingInterval::"+t;if(!(performance&&performance.mark&&performance.measure&&performance.now&&performance.clearMarks))return function(){};var i=null,o=0,l=0,c=null,f=function(){o=d,null===i&&(performance.mark(a),c=performance.now(),l=0,i=requestAnimationFrame(function e(){if(l++,--o>0)i=requestAnimationFrame(e);else{i=null;var t=performance.now();performance.mark(n),performance.measure(r,a,n),performance.clearMarks(a),performance.clearMarks(n);var u=(t-c)/l;u>m&&Object(s.o)("dropped_frame_while_typing",[u])}}))};return e.addEventListener("keydown",f,!0),function(){e.removeEventListener("keydown",f,!0)}}(this.editorDiv,"ReactEditor"))},ReactEditor.prototype.componentWillUnmount=function(){if(this.editor){if(this.props.logPerfDataCallback){var e=y(this.editor);this.props.logPerfDataCallback(e)}this.editor.dispose()}this.editor=null,null!==this.dirAttributeMutationObserver&&(this.dirAttributeMutationObserver.disconnect(),this.dirAttributeMutationObserver=null),this.unregisterLogOnFrameDropWhileTyping&&this.unregisterLogOnFrameDropWhileTyping()},ReactEditor.prototype.UNSAFE_componentWillReceiveProps=function(e){e.viewState!==this.props.viewState&&this.setEditorContent(e.viewState.content),e.isDarkMode!==this.props.isDarkMode&&this.setDarkMode(e.isDarkMode)},ReactEditor.prototype.render=function(){var e=this,t=this.props,a=t.onFocus,n=t.classNames,r=t.isRtl,i=t.showFormatPainterCursor,o=t.watermark,l=t.ariaLabel,c=t.isDarkMode,s=i?{cursor:'url("'+H+'") 8.5 16, auto'}:null;return U.createElement("div",{contentEditable:!0,ref:function(t){return e.editorDiv=t},dir:r?"rtl":"ltr",className:W(n,K.textSelectable,{resetColors:!c}),onBlur:this.onBlur,onFocus:a,style:s,role:"textbox","aria-multiline":"true","aria-label":l||o})},ReactEditor.prototype.focus=function(){this.editor&&this.editor.focus()},ReactEditor.prototype.getContent=function(){return this.editor.getContent()},ReactEditor.prototype.updateContentToViewState=function(e){this.viewStateManagePlugin.updateContentToViewState(e)},ReactEditor.prototype.externalContentTransform=function(e){Object(M.a)(e,Object(A.e)("cmp-darkModeSimpleRecolor"))||"A"!=e.tagName||(e.style.color="rgb(228, 159, 255)")},ReactEditor.prototype.getEditorOptions=function(){var e=this.props,t=e.plugins,a=e.viewState,r=e.watermark,i=e.logPerfDataCallback,o=e.isDarkMode,s=e.scrollContainerSelector,u=t?n.__spread(t):[],d=Object(c.a)();u=n.__spread(u,[this.contentEditPlugin,this.hyperLinkPlugin,this.pastePlugin,this.tableResizePlugin,this.customReplacePlugin,r&&new V.Watermark(r,Q),this.viewStateManagePlugin]);var m,h=(m=this.pastePlugin,{cacheGetContentSearcher:f.cacheGetContentSearcher,clearContentSearcherCache:f.clearContentSearcherCache,replaceWithNode:w.replaceWithNode,matchWhiteSpaces:j,editTable:w.editTable,formatTable:w.formatTable,pasteOriginal:function(e){return m.pasteOriginal(e)},pasteText:function(e){return m.pasteText(e)},pasteAndMergeFormat:function(e){return m.pasteAndMergeFormat(e)},isNodeBlockElement:function(e){return e instanceof C.NodeBlockElement},createVTable:function(e){return new C.VTable(e)}});u.forEach(function(e){var t=e;t&&t.setPluginUtils&&t.setPluginUtils(h)});var b=z.HtmlSanitizer.convertInlineCss(a.content);return{plugins:u,defaultFormat:d,undo:new F(a),initialContent:b,inDarkMode:o,scrollContainer:s&&Object(C.findClosestElementAncestor)(this.editorDiv,document.body,s),darkModeOptions:o||Object(A.e)("cmp-darkModeToggle")?{transformOnInitialize:!0,onExternalContentTransform:this.externalContentTransform}:{},coreApiOverride:n.__assign({},i?{triggerEvent:O}:{},Object(A.e)("cmp-prague")?{attachDomEvent:l}:{})}},ReactEditor.prototype.setEditorContent=function(e){var t=z.HtmlSanitizer.convertInlineCss(e);this.editor.setContent(t,!0),this.updateContentToViewState(!0)},ReactEditor.prototype.setDarkMode=function(e){this.editor.setDarkModeState(e)},ReactEditor=n.__decorate([o.observer],ReactEditor)}(U.Component);t.a=Y},4989:function(e,t,a){var n=a(5252),r=a(31);"string"==typeof n&&(n=[[e.i,n]]);for(var i=0;i<n.length;i++)r.loadStyles(n[i][1],!1);n.locals&&(e.exports=n.locals)},5229:function(e){e.exports={c:"eda",a:"fda",b:"gda"}},5251:function(e,t,a){e.exports=a.p+"../resources/images/formatpaintercursor-fca25bebfad3d9508f1007ad32f3fd7f.svg"},5252:function(e,t,a){(t=e.exports=a(30)(!1)).push([e.i,"._2s9KmFMlfdGElivl0o-GZb{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary)}html[dir] ._2s9KmFMlfdGElivl0o-GZb{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white)}._17ghdPL1NLKYjRvmoJgpoK{user-select:text;-moz-user-select:text;-ms-user-select:text;-webkit-user-select:text}",""]),t.locals={resetColors:"_2s9KmFMlfdGElivl0o-GZb",textSelectable:"_17ghdPL1NLKYjRvmoJgpoK"}},5701:function(e,t,a){"use strict";var n=a(2);t.a=Object(n.action)("initLoadMailboxAutomaticRepliesConfiguration")},6370:function(e,t,a){"use strict";var n=a(2);t.a=Object(n.action)("navigateToOofPivot")},6888:function(e,t,a){"use strict";var n=a(2);t.a=Object(n.action)("onAutomaticRepliesOptionMounted")},7851:function(e,t,a){"use strict";a.d(t,"a",function(){return o});var n=a(7852),r=a.n(n),i=a(26);function o(e){return r()({Header:Object(i.getJsonRequestHeader)(),Options:e})}},7854:function(e){e.exports={a:"TQa"}},7855:function(e){e.exports={a:"NQa"}},7856:function(e){e.exports={a:"LQa",b:"MQa"}},7857:function(e){e.exports={a:"KQa"}},9281:function(e,t,a){"use strict";a.r(t);var n=a(2),r=a(44),i=a(61),o=a(5701),l=a(6370),c=a(4435),s=a(1450),u=Object(n.mutatorAction)("setDeclineNewInvitationsEnabled",function(e){Object(s.a)().oofViewState.declineNewInvitationsEnabled=e}),d=Object(n.mutatorAction)("setDeclineExistingCalendarEventsEnabled",function(e){Object(s.a)().oofViewState.declineExistingCalendarEventsEnabled=e}),m=Object(n.mutatorAction)("enableAutoReplyEditor",function(e){Object(s.a)().oofViewState.autoReplyEnabled=e}),f=Object(n.mutatorAction)("setOofAutoReplyMessage",function(e){Object(s.a)().oofViewState.autoReplyViewState=e}),h=Object(n.mutatorAction)("setHideOverridingWarningMessage",function(e){Object(s.a)().oofViewState.hideOverridingWarningMessage=e}),b=Object(n.mutatorAction)("setAutomaticRepliesOptionLoadingStatus",function(e){var t=Object(s.a)();t&&(t.oofViewState.optionsPageLoadingState=e)}),p=a(174),g=a(2265),v=a(3618),y=a(5),S=a(4791),O=a(5989),k=a(41);Object(n.orchestrator)(l.a,function(){var e=Object(s.a)().oofViewState,t=e.mailboxAutoReplyConfiguration;if(t){Object(i.Tb)([]),Object(i.Xb)([]),Object(c.c)(Object(v.a)()),Object(g.b)(null,Object(p.a)().event);var a=e.startDate,n=e.endDate;if(!a&&!n){var l=Object(p.a)().event;Object(O.a)(t)||!Object(y.zb)(l.End,Object(y.Jb)())?(a=Object(y.cc)(t.StartTime),n=Object(y.cc)(t.EndTime)):l.IsAllDayEvent?(a=Object(y.Qb)(l.Start),n=Object(y.Qb)(Object(y.e)(l.End,1))):(a=l.Start,n=l.End)}if(Object(i.Qb)({start:a,end:n}),Object(i.Hb)(!1),Object(i.Rb)("OOF"),Object(i.O)(Object(k.u)().id),e.autoReplyViewState)f(e.autoReplyViewState);else if(!Object(r.a)()){var d=!!t.InternalMessage;m(d),f(Object(v.a)(t.InternalMessage,!1))}else{d=!!t.ExternalMessage;m(d),f(Object(v.a)(t.ExternalMessage,!1))}void 0===e.declineNewInvitationsEnabled?u(t.AutoDeclineFutureRequestsWhenOOF):u(e.declineNewInvitationsEnabled)}else{var h=e.mailboxAutoReplyConfigurationLoadingStatus;h&&h!==S.a.Failed||Object(o.a)()}});var C=a(3),w=a(6888),E=new C.c(function(){return a.e(494).then(a.bind(null,13876))}),j=new C.a(E,function(e){return e.setAutomaticRepliesCurrentState}),M=a(329);Object(n.orchestrator)(c.a,function(){var e=Object(s.a)().oofViewState,t=e.declineNewInvitationsEnabled,a=e.declineExistingCalendarEventsEnabled,n=e.autoReplyEnabled,r=e.autoReplyViewState,i=Object(p.a)().event,o={isAutomaticReplyEnabled:!0,periodicReplyEnabled:!0,startDate:i.Start,endDate:i.End,blockCalendarEnabled:!0,blockCalendarTitle:i.Subject,declineNewInvitationsEnabled:t,declineExistingCalendarEventsEnabled:a,declineAllExistingCalendarEvents:a,editorViewStateMessage:n?r:Object(v.a)()};j.importAndExecute(o).then(function(){b(S.a.Pending),M.e.importAndExecute("mail","automaticReplies","automaticRepliesOption")})});var N=a(0),T=a(7851),A=a(5593),B=a(686),x=a(1764),D=a(2536),P=a(1415),L=a(4),F=a(5988);Object(n.orchestrator)(A.a,function(){Object(F.b)(F.a.Save);var e=Object(p.a)().event,t=e.Start,a=e.End,n=e.Subject,o=Object(s.a)().oofViewState,l=o.autoReplyEnabled&&o.autoReplyViewState?o.autoReplyViewState.content:"",c=!Object(r.a)(),u=c?0:o.mailboxAutoReplyConfiguration.ExternalAudience,d=o.declineExistingCalendarEventsEnabled,m=o.declineNewInvitationsEnabled,f={AutoReplyState:2,CreateOOFEvent:!0,OOFEventSubject:n,InternalMessage:c?l:"",ExternalMessage:c?"":l,AutoDeclineFutureRequestsWhenOOF:m,DeclineEventsForScheduledOOF:d,DeclineAllEventsForScheduledOOF:d,DeclineMeetingMessage:m||d?l:void 0,ExternalAudience:u,StartTime:Object(y.ob)(t),EndTime:Object(y.ob)(a)};Object(i.j)(!1,!1),function e(t){return N.__awaiter(this,void 0,void 0,function(){return N.__generator(this,function(a){switch(a.label){case 0:return[4,Object(T.a)(t)];case 1:return a.sent().WasSuccessful?B.e.import().then(function(e){e("saveQuickComposeOof","Surface",Object(L.a)(D.a),{icon:"CheckMark"})}):B.f.import().then(function(a){a("saveQuickComposeOof","Surface",Object(L.a)(P.a),Object(L.a)(x.a),function(){e(t)},"Error",B.a.Retry)}),[2]}})})}(f)});var R=a(326);Object(n.orchestrator)(w.a,function(){var e=Object(p.a)();e&&e.openedForm===R.f&&(b(S.a.Succeeded),Object(i.j)(!1,!1))});var I=a(7854),_=a(11873),G=a(7855),U=a(7856),z=a(7857),V=a(1),H=a(4932),K=a(5594),W=a(362),Q=a(19),Y=a(1776),J=a(3677),q=a(3379),ReactEditor=a(4711),Z=a(1562),$=a(193),X=a(180),ee=a(4081),te=a(3536),ae=a(888),ne=a(5263),re=a(115).bind(ne),ie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return N.__extends(t,e),t.prototype.componentDidUpdate=function(){(0,this.props.onSizeUpdate)()},t.prototype.render=function(){var e=this.props.colorScheme,t=Object(X.m)(e),a=Object(s.a)().oofViewState,n=a.declineNewInvitationsEnabled,i=a.declineExistingCalendarEventsEnabled,l=a.autoReplyEnabled,c=a.autoReplyViewState,u=a.mailboxAutoReplyConfigurationLoadingStatus,d=a.mailboxAutoReplyConfiguration,m=a.hideOverridingWarningMessage,f=a.optionsPageLoadingState,h=u===S.a.Pending||f===S.a.Pending,b=!m&&Object(O.a)(d),p=u===S.a.Failed;return V.createElement("div",{className:ne.oofComposeContainer},b&&V.createElement(ee.a,{className:ne.warningMessageBar,messageBarType:te.a.warning,onDismiss:this.onWarningMessageBarDismissed,dismissButtonAriaLabel:Object(L.a)(_.a),actions:V.createElement(ae.a,{onClick:this.navigateToOptionsPage},Object(L.a)(_.e))},Object(L.a)(_.d)),V.createElement("div",{className:ne.titleContainer},V.createElement(K.a,{colorScheme:e,isInEditMode:!1,charmDisabled:!0})),V.createElement("div",{className:re(ne.composeRow,ne.dateTimeContainer)},V.createElement(W.a,{iconName:"Clock",className:ne.clockRowIcon}),V.createElement(H.a,{isNarrow:!0,timeChangeActionType:J.a.QuickComposeTimeControls,onDateTimesChanged:this.onDateTimesChanged})),V.createElement(q.a,{className:ne.optionsCheckbox,key:"decline_new_invitations",checked:n,label:Object(L.a)(z.a),onChange:this.toggleDeclineNewInvitations,theme:t}),V.createElement(q.a,{className:ne.optionsCheckbox,key:"decline_existing_events",checked:i,label:Object(L.a)(U.a),onChange:this.toggleDeclineExistingCalendarEvents,theme:t}),V.createElement(q.a,{className:ne.optionsCheckbox,key:"send_automatic_reply",checked:l,label:Object(r.a)()?Object(L.a)(_.c):Object(L.a)(G.a),onChange:this.toggleSendAutoReply,theme:t}),l&&V.createElement("div",{className:ne.autoReplyContainer},V.createElement(ReactEditor.a,{viewState:c,classNames:re(ne.editor,{expanded:l}),plugins:[],watermark:Object(L.a)(I.a),ariaLabel:Object(L.a)(I.a),updateOnKeyPress:!0})),h&&V.createElement(Z.a,{size:$.a.large,theme:t,className:ne.oofBackdrop}),p&&V.createElement("div",{className:ne.oofBackdrop},V.createElement("div",{className:ne.errorMessageBarRoot},V.createElement(ee.a,{messageBarType:te.a.error,isMultiline:!0,actions:V.createElement(ae.a,{onClick:o.a},Object(L.a)(x.a))},Object(L.a)(_.b)))))},t.prototype.onDateTimesChanged=function(){Object(i.y)(Y.o.DateTime,!0)},t.prototype.toggleDeclineNewInvitations=function(e,t){u(t)},t.prototype.toggleDeclineExistingCalendarEvents=function(e,t){d(t)},t.prototype.toggleSendAutoReply=function(){var e=Object(s.a)().oofViewState.autoReplyEnabled;m(!e)},t.prototype.onWarningMessageBarDismissed=function(){h(!0)},t.prototype.navigateToOptionsPage=function(){Object(F.b)(F.a.OptionsPageFromMessageBar),Object(c.a)()},t=N.__decorate([Q.observer],t)}(V.Component),oe=a(6637),le=a(2944),ce=a(5263),se=a(115).bind(ce),ue=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onEditorButtonClicked=function(){Object(c.d)(!0)},t}return N.__extends(t,e),t.prototype.componentDidUpdate=function(){this.reactEditor&&this.reactEditor.focus()},t.prototype.render=function(){var e=this,t=Object(s.a)(),a=se(ce.editor,{expanded:t.showExpandedEditor});return V.createElement("div",{className:ce.editorComposeRow},V.createElement(W.a,{iconName:"List",className:ce.editorRowIcon}),t.showExpandedEditor?V.createElement("div",{className:ce.editorContainer},V.createElement(ReactEditor.a,{viewState:t.bodyViewState,classNames:a,plugins:[],ref:function(t){e.reactEditor=t},watermark:Object(L.a)(oe.b),ariaLabel:Object(L.a)(oe.b),updateOnKeyPress:!0})):V.createElement(le.a,{className:ce.editorLink,onClick:this.onEditorButtonClicked},Object(L.a)(oe.b)))},t=N.__decorate([Q.observer],t)}(V.Component);a.d(t,"navigateToOofPivot",function(){return l.a}),a.d(t,"OOFContent",function(){return ie}),a.d(t,"QuickComposeEditor",function(){return ue})}},0,[5,15,40,85,344,6,7,9,14,142,157,240,514,105,557,335,24,116,114,172,173,495]]);
//# sourceMappingURL=owa.QuickComposeContents.js.map
self.scriptsLoaded['owa.QuickComposeContents.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.QuickComposeContents.js'] = (new Date()).getTime();