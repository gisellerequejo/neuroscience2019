self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.RelatedContentInitialization.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[384],{3100:function(n,t,e){"use strict";e.r(t);var r=e(2),u=Object(r.action)("initializeEventRelatedContent"),i=Object(r.action)("prefetchInsights",function(n){return{events:n}}),c=e(3761),o=e(445),a=e(5),f=e(47),s=e(154),d=new o.a(3,function(n){var t=n.ItemId.Id;return c.n.importAndExecute(t,3).catch(function(){})},500);Object(r.orchestrator)(i,function(n){if(Object(c.m)())for(var t=n.events,e=Object(f.d)(Object(a.Qb)(Object(a.bc)()),3),r=Object(s.l)(t,[e]).eventsOverlapping,u=Math.min(r.length,c.a),i=0;i<u;i++){var o=r[i];Object(c.l)(o.ItemId.Id)&&d.add(o)}});var b=e(0),l=e(95),v=e(65),j=e(11);Object(r.orchestrator)(u,function(n){return b.__awaiter(void 0,void 0,void 0,function(){var n;return b.__generator(this,function(t){switch(t.label){case 0:if(!Object(c.m)())return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,Object(v.e)("ows/api/beta/events/relatedContent/warmup",{},"",!0)];case 2:return t.sent(),[3,4];case 3:return n=t.sent(),j.d.warn("[initializeEventRelatedContent failed] : "+n),[3,4];case 4:return setTimeout(function(){u()},l.a.MillisecondsInOneDay),[2]}})})});e.d(t,"initializeEventRelatedContent",function(){return u}),e.d(t,"prefetchInsights",function(){return i})},3495:function(n,t,e){"use strict";e.d(t,"c",function(){return u}),e.d(t,"e",function(){return i}),e.d(t,"d",function(){return c}),e.d(t,"f",function(){return o}),e.d(t,"b",function(){return a}),e.d(t,"a",function(){return f});var r=e(3689);function u(n){return Object(r.b)().meetingIdToInsightsMap.get(n)}function i(n){var t=u(n);return t?t.files.filter(function(n){return!n.isMeetingAttachment}):[]}function c(n){var t=u(n);return t?t.emails:[]}function o(n){return i(n).length+c(n).length}function a(n){var t=u(n);return t?t.files.filter(function(n){return n.isMeetingAttachment}):[]}function f(n){var t=u(n);return t&&0!==t.files.length?t.files:[]}},3689:function(n,t,e){"use strict";e.d(t,"b",function(){return c});var r=e(3717),u=e(2),i={meetingIdToInsightsMap:new(e(7).ObservableMap)({}),peopleInsightCount:null,pendingServiceQueue:[]};r.b.initialize(i.meetingIdToInsightsMap);var c=Object(u.createStore)("meetingInsightsStore",i);t.a=c()},3717:function(n,t,e){"use strict";e.d(t,"a",function(){return u});var r=e(910),u=20,i=new r.a(u);t.b=i},3718:function(n,t,e){"use strict";e.d(t,"b",function(){return s}),e.d(t,"a",function(){return d});var r=e(6),u=e(10),i=e(41),c=e(11),o=e(124),a=e(154),f=e(25);function s(){return Object(r.e)("cal-relatedContent-filesAndEmailsUX")&&Object(u.a)().SessionSettings.IsSubstrateSearchServiceAvailable&&!Object(f.p)()}function d(n){var t=Object(a.k)(n);if(!t)return!1;var e=t.IsMeeting,r=t.ParentFolderId.Id,u=Object(i.m)(r);return u?!!e&&!u.IsGroupMailboxCalendar&&!Object(o.A)(t):(c.d.error("calendarEntry should not be null"),!1)}},3719:function(n,t,e){"use strict";e.d(t,"b",function(){return a}),e.d(t,"a",function(){return f});var r=e(4207),u=e(4208),i=e(4),c=e(5);function o(n,t){var e=Object(c.Db)(n,Object(c.Jb)())?Object(c.W)(n):Object(c.U)(n);return Object(i.b)(t,e)}function a(n,t,e){return e&&!n?o(e,Object(i.a)(u.a)):t?o(t,Object(i.a)(r.a)):""}function f(n){return o(n,"{0}")}},3761:function(n,t,e){"use strict";var r=e(3),u=e(3717),i=e(3689),c=e(3718),o=e(3495),a=e(3719);function f(n){var t=Object(o.c)(n);return t?t.dataFetchSource:null}function s(n){var t=Object(o.c)(n);return t?t.traceId:null}e.d(t,"n",function(){return b}),e.d(t,"o",function(){return l}),e.d(t,"b",function(){return v}),e.d(t,"a",function(){return u.a}),e.d(t,"g",function(){return i.b}),e.d(t,"m",function(){return c.b}),e.d(t,"l",function(){return c.a}),e.d(t,"h",function(){return o.d}),e.d(t,"j",function(){return o.e}),e.d(t,"k",function(){return o.f}),e.d(t,"d",function(){return o.b}),e.d(t,"c",function(){return o.a}),e.d(t,"i",function(){return a.a}),e.d(t,"e",function(){return f}),e.d(t,"f",function(){return s});var d=new r.c(function(){return Promise.all([e.e(10),e.e(19),e.e(20),e.e(327)]).then(e.bind(null,13742))}),b=new r.a(d,function(n){return n.fetchMeetingInsights}),l=new r.a(d,function(n){return n.setPeopleInsightCountState}),v=Object(r.d)(d,function(n){return n.InsightDocRow})},4207:function(n){n.exports={a:"tVa"}},4208:function(n){n.exports={a:"uVa"}}},0,[6,7,9,14,142,157,240,514,105,557,335,24,116,495]]);
//# sourceMappingURL=owa.RelatedContentInitialization.js.map
self.scriptsLoaded['owa.RelatedContentInitialization.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.RelatedContentInitialization.js'] = (new Date()).getTime();