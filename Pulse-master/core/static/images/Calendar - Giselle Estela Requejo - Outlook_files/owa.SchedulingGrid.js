self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.SchedulingGrid.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[397],{1702:function(e,t,r){var o=r(2336),n=r(31);"string"==typeof o&&(o=[[e.i,o]]);for(var i=0;i<o.length;i++)n.loadStyles(o[i][1],!1);o.locals&&(e.exports=o.locals)},2336:function(e,t,r){(t=e.exports=r(30)(!1)).push([e.i,'._1y5pb2-D7-eeKRS8slh3lk{position:absolute;-webkit-box-sizing:border-box;box-sizing:border-box;min-width:6px;z-index:2;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;color:"[theme:themePrimary, default:#0078D4]"}html[dir] ._1y5pb2-D7-eeKRS8slh3lk{border-width:1px;padding-top:1px;margin-bottom:2px;border-radius:2px}html[dir=ltr] ._1y5pb2-D7-eeKRS8slh3lk{margin-right:1px}html[dir=rtl] ._1y5pb2-D7-eeKRS8slh3lk{margin-left:1px}._1y5pb2-D7-eeKRS8slh3lk ._3iUOQDlNffxRHEF0WlbdPO{display:none}._1y5pb2-D7-eeKRS8slh3lk ._3iUOQDlNffxRHEF0WlbdPO:active,._1y5pb2-D7-eeKRS8slh3lk ._3iUOQDlNffxRHEF0WlbdPO:hover{display:block}._1y5pb2-D7-eeKRS8slh3lk:hover{z-index:3}._1y5pb2-D7-eeKRS8slh3lk:hover ._3iUOQDlNffxRHEF0WlbdPO{display:block}html[dir] ._1_onueHQxwER7bIP-Nqper{margin:0 8px}._3nDAFNaqlTOOI7sajd6uBA{cursor:default;z-index:4}html[dir] ._3nDAFNaqlTOOI7sajd6uBA{background-color:"[theme:white, default:#ffffff]"}._3nDAFNaqlTOOI7sajd6uBA ._3iUOQDlNffxRHEF0WlbdPO{display:block}._3E7rEp1ngOl2mJxxJx5n_D{color:"[theme:neutralLight, default:#eaeaea]"}html[dir=ltr] ._3E7rEp1ngOl2mJxxJx5n_D{padding-left:1px}html[dir=rtl] ._3E7rEp1ngOl2mJxxJx5n_D{padding-right:1px}._6NJpXogPtosBpQ89FgQaW{position:absolute;-webkit-box-sizing:border-box;box-sizing:border-box;color:"[theme:neutralSecondary, default:#666666]";font-weight:400;font-size:17px}html[dir] ._6NJpXogPtosBpQ89FgQaW{border-top:1px solid;border-top-color:"[theme:neutralLight, default:#eaeaea]"}._366aQPsNQX0RPd6enE8HBz{color:"[theme:neutralPrimary, default:#333333]"}._2eo_uWJta07mDtyee81Z9z{position:absolute;height:8px;z-index:2}html[dir=ltr] ._2eo_uWJta07mDtyee81Z9z,html[dir=rtl] ._2eo_uWJta07mDtyee81Z9z{left:0;right:0}._1qXmCdGrdVGOUjTzLwLGW1{top:-4px;cursor:n-resize}._1qXmCdGrdVGOUjTzLwLGW1.BWjiCQuY0Ov8FzxZ_Jyxu{cursor:inherit!important}._3_9zu_L0JCL9LSr3cS31cQ{bottom:-2px;cursor:s-resize}._3_9zu_L0JCL9LSr3cS31cQ.BWjiCQuY0Ov8FzxZ_Jyxu{cursor:inherit!important}._2XQrMMahIpTPhfDOfq6EMF{position:absolute;z-index:3;cursor:-webkit-grab;cursor:-o-grab;cursor:-ms-grab;cursor:grab}._2XQrMMahIpTPhfDOfq6EMF:active{cursor:-webkit-grabbing;cursor:-o-grabbing;cursor:-ms-grabbing;cursor:grabbing}._2XQrMMahIpTPhfDOfq6EMF._3THBjdZMUEzmBaCfjVwvEW{cursor:n-resize}._2XQrMMahIpTPhfDOfq6EMF.nm4SQuWzha3o4mtxobgiu{cursor:s-resize}.itemFocused,.itemHovered,.itemSelected{display:block}html[dir] ._2Bc4lasFXWKe0o-Ukv20C2:hover{background-color:"[theme:white, default:#ffffff]"}html[dir=ltr] ._2Bc4lasFXWKe0o-Ukv20C2:hover{left:0!important;right:0!important;-webkit-transition:left .2s cubic-bezier(0,1,0,1) .5s,right .2s cubic-bezier(0,1,0,1) .5s;transition:left .2s cubic-bezier(0,1,0,1) .5s,right .2s cubic-bezier(0,1,0,1) .5s}html[dir=rtl] ._2Bc4lasFXWKe0o-Ukv20C2:hover{right:0!important;left:0!important;-webkit-transition:right .2s cubic-bezier(0,1,0,1) .5s,left .2s cubic-bezier(0,1,0,1) .5s;transition:right .2s cubic-bezier(0,1,0,1) .5s,left .2s cubic-bezier(0,1,0,1) .5s}',""]),t.locals={item:"_1y5pb2-D7-eeKRS8slh3lk",resizeBox:"_3iUOQDlNffxRHEF0WlbdPO",monthItem:"_1_onueHQxwER7bIP-Nqper",itemDragHelper:"_3nDAFNaqlTOOI7sajd6uBA",isAllDayItem:"_3E7rEp1ngOl2mJxxJx5n_D",dayCell:"_6NJpXogPtosBpQ89FgQaW",dayCellCurrentMonth:"_366aQPsNQX0RPd6enE8HBz",resizableEdge:"_2eo_uWJta07mDtyee81Z9z",topResizable:"_1qXmCdGrdVGOUjTzLwLGW1",move:"BWjiCQuY0Ov8FzxZ_Jyxu",bottomResizable:"_3_9zu_L0JCL9LSr3cS31cQ",dragBlock:"_2XQrMMahIpTPhfDOfq6EMF",topResize:"_3THBjdZMUEzmBaCfjVwvEW",bottomResize:"nm4SQuWzha3o4mtxobgiu",expandable:"_2Bc4lasFXWKe0o-Ukv20C2"}},5520:function(e,t,r){"use strict";r.r(t);var o=r(0),n=r(100),i=r(154);function s(e,t){var r=[];return e&&r.push(e),t&&-1==r.indexOf(t)&&r.push(t),r}var a=r(36),c=r(5),l=r(2),u=r(3616);function d(e){return{start:Object(c.Qb)(e),end:Object(c.A)(e)}}var b=r(47),p=r(10),h=r(85);var m=r(3559),f=Object(l.action)("schedulingGrid-selectedDateChanged",function(e,t){return{viewStateHost:e,newDate:t}}),g=Object(l.action)("schedulingGrid-selectedItemChanged",function(e,t){return{viewStateHost:e,selectionItem:t}});Object(l.mutator)(m.a,function(e){var t,r,l=e.viewStateHost,m=e.folderIds,f=e.selectedDate,g=e.selectionItem,v=e.filterItemsFunction,S=e.showFreeBusy,O=e.useFreeBusyForDefaultCalendar,y=e.disableTabbableSurfaceItems;l.schedulingGridViewState=o.__assign({},Object(n.B)(),{dateRangeType:a.a.Day,dateRange:d(f||Object(c.Jb)()),userOptions:(t=Object(p.a)(),r=t.UserOptions,{isRTL:t.SessionSettings.IsUserCultureRightToLeft,weekStartDay:r.WeekStartDay,hourIncrement:r.HourIncrement,showWeekNumbers:r.ShowWeekNumbers,firstWeekOfYear:r.FirstWeekOfYear,workHoursStartTimeInMinutes:r.WorkingHours.WorkHoursStartTimeInMinutes,workHoursEndTimeInMinutes:r.WorkingHours.WorkHoursEndTimeInMinutes,workDays:r.WorkingHours.WorkDays?Object(b.i)(r.WorkingHours.WorkDays):Object(b.i)(h.c)}),disableTabbableSurfaceItems:y,enableDragDrop:!1,timeZoneIds:g?s(g.Start.tz,g.End.tz):[(f||Object(c.Jb)()).tz],selectedDate:g?g.Start:null,filterItemsFunction:v||function(e){return e},eventsCacheLockId:Object(i.d)().getLockId(),selectionItem:g?Object(u.a)(g,n.k.suggestedItems):void 0,folderIds:m,showFreeBusy:S,useFreeBusyForDefaultCalendar:O,collapsedAllDayWellHeight:h.d.defaultAllDayWellCollapsedHeight})}),Object(l.mutator)(m.e,function(e){var t=e.viewStateHost,r=e.folderIds;t.schedulingGridViewState.folderIds=r}),Object(l.mutator)(f,function(e){var t=e.viewStateHost,r=e.newDate;t.schedulingGridViewState.selectedDate=r,t.schedulingGridViewState.dateRange=d(r)}),Object(l.mutator)(g,function(e){var t=e.viewStateHost,r=e.selectionItem,o=s(r.Start.tz,r.End.tz);o.some(function(e,r){return t.schedulingGridViewState.timeZoneIds[r]!=e})&&(t.schedulingGridViewState.timeZoneIds=o),t.schedulingGridViewState.selectionItem=Object(u.a)(r,n.k.suggestedItems)}),Object(l.mutator)(m.d,function(e){e.viewStateHost.schedulingGridViewState=null});var v=30;var S=r(41),O=r(337);function y(e,t,r,s){return o.__awaiter(this,void 0,void 0,function(){var a,l,d,b,p,h,m,f,g,y,D,j,w,I,_;return o.__generator(this,function(z){switch(z.label){case 0:if(a=e.eventsCacheLockId,l=e.filterItemsFunction,null==t&&(t=e.folderIds),null==r&&(r=e.dateRange),null==s&&(s=e.selectionItem),d=e.showFreeBusy?function(e){for(var t=[],r=e.start,o=Object(c.h)(r,v);Object(c.Bb)(r,e.end);r=o,o=Object(c.h)(o,v))t.push(Object(u.a)({Start:r,End:o,IsAllDayEvent:!1},n.k.attendeesItems));return t}(r):[],s&&s.IsAllDayEvent&&d.push(s),b=!1,p=null,e.useFreeBusyForDefaultCalendar&&1===t.length&&(h=Object(S.s)(t[0]),p=h?h.mailboxInfo.primarySmtpAddress:void 0,m=p?Object(S.u)(p):void 0,(m?m.calculatedFolderId:void 0)===t[0]&&(b=!0,f=function(t){var r=t[p];if(r&&r.Items){var i=r.Items.map(function(e){return Object(O.a)(e,h.mailboxInfo)});d.push.apply(d,o.__spread(i))}Object(n.t)(l(d),e,!0)},Object(i.h)(Object(c.cc)(r.start),Object(c.cc)(r.end),[p],f,!0,h.mailboxInfo))),b)return[3,9];g=Object(i.r)(a),z.label=1;case 1:z.trys.push([1,6,7,8]),y=o.__values(t),D=y.next(),z.label=2;case 2:return D.done?[3,5]:(j=D.value,[4,g.fetchCalendarEventsForDateRange(j,r).fetchPromise.then(function(e){return d.push.apply(d,o.__spread(e))})]);case 3:z.sent(),z.label=4;case 4:return D=y.next(),[3,2];case 5:return[3,8];case 6:return w=z.sent(),I={error:w},[3,8];case 7:try{D&&!D.done&&(_=y.return)&&_.call(y)}finally{if(I)throw I.error}return[7];case 8:Object(n.t)(l(d),e,!0),z.label=9;case 9:return[2]}})})}Object(l.orchestrator)(m.e,function(e){var t=e.viewStateHost,r=e.folderIds;y(t.schedulingGridViewState,r)}),Object(l.orchestrator)(m.b,function(e){var t=e.viewStateHost,r=e.newDate,o=Object(c.Qb)(r);t.schedulingGridViewState.selectedDate&&Object(c.Cb)(Object(c.Qb)(t.schedulingGridViewState.selectedDate),o)||(f(t,o),y(t.schedulingGridViewState,null,d(r)))}),Object(l.orchestrator)(m.f,function(e){var t=e.viewStateHost,r=e.selectionItem,o=t.schedulingGridViewState.selectionItem&&t.schedulingGridViewState.selectionItem.IsAllDayEvent;g(t,r),r&&o!=r.IsAllDayEvent&&y(t.schedulingGridViewState,null,null,r)}),Object(l.orchestrator)(m.a,function(e){var t=e.viewStateHost,r=e.folderIds,o=e.selectedDate,n=e.selectionItem;y(t.schedulingGridViewState,r,d(o),n)}),Object(l.orchestrator)(m.c,function(e){y(e.viewStateHost.schedulingGridViewState)}),Object(l.orchestrator)(m.d,function(e){var t=e.eventsCacheLockId;t&&Object(i.r)(t).release()});var D=r(19),j=r(43),w=r(1),I=r(1702),_=r(115).bind(I),z=function(e){function t(t){var r=e.call(this,t)||this;return r.onTopResizeStart=function(e){r.beginDrag(e,r.onResizeMouseMove,function(){r.resizeEdge=!0,document.body.style.cursor="n-resize",r.setState({dragClass:I.topResize})})},r.onBottomResizeStart=function(e){r.beginDrag(e,r.onResizeMouseMove,function(){r.resizeEdge=!1,document.body.style.cursor="s-resize",r.setState({dragClass:I.bottomResize})})},r.onResizeMouseMove=function(e){var t=r.getCurrentCellRange(e),o=r.props,n=o.getSelection,i=o.setTimeSelection,s=n(),a=s.Start,l=s.End;Object(c.zb)(t.end,l)?r.resizeEdge?i(Object(c.h)(l,-1*r.props.surfaceStore.userOptions.hourIncrement),l):(i(a,t.end),r.resizeEdge=!1):Object(c.Bb)(t.start,a)?r.resizeEdge?(i(t.start,l),r.resizeEdge=!0):i(a,Object(c.h)(a,r.props.surfaceStore.userOptions.hourIncrement)):1==r.resizeEdge?!Object(c.Cb)(t.start,a)&&i(t.start,l):0==r.resizeEdge&&!Object(c.Cb)(t.end,l)&&i(a,t.end)},r.onMouseDown=function(e){r.beginDrag(e,r.onMouseMove,function(){document.body.style.cursor="pointer";var t=r.props.getSelection,o=Object(c.x)(t().Start,r.getCurrentCellRange(e.nativeEvent).start);r.setState({dragClass:I.move,offset:o})})},r.onMouseUp=function(e){document.onmouseup=null,document.onmousemove=null,document.body.style.cursor="default",r.setState({dragClass:""})},r.onMouseMove=function(e){var t=r.props,o=t.getSelection,n=t.setTimeSelection,i=r.getCurrentCellRange(e).start,s=o(),a=Object(c.h)(i,r.state.offset);if(!Object(c.Cb)(s.Start,a)){var l=Object(c.x)(s.End,s.Start);n(a,Object(c.h)(a,l))}},r.createSurfaceItemByKey=function(e){var t=r.props.config;return Object(n.G)(e.ItemId.Id,e,t.columnProvider)},r.onKeyDown=function(e){var t=r.props.surfaceStore;e.keyCode==j.a.up&&r.moveSelection(-t.userOptions.hourIncrement,e),e.keyCode==j.a.down&&r.moveSelection(t.userOptions.hourIncrement,e),e.keyCode==j.a.left&&r.moveDays(-1,e),e.keyCode==j.a.right&&r.moveDays(1,e)},r.state={dragClass:""},r}return o.__extends(t,e),t.prototype.onAttach=function(e){this.parent=e},t.prototype.handlers=function(){return{onKeyDown:this.onKeyDown,onFocus:this.onFocus}},t.prototype.render=function(){var e=this.props,t=e.config,r=e.getSelection,o=e.surfaceStore,i=r();if(i.IsAllDayEvent)return null;var s=t.columnProvider.getColumnIntervals(i);if(!s||0==s.length)return null;var a=this.createSurfaceItemByKey(i),c=t.itemsLayout.getVerticalLayout(s[0]),l=t.getItemConfig(i),u=_(I.dragBlock,this.state.dragClass),d={top:Object(n.X)(c.top),bottom:Object(n.X)(1-(c.top+c.height)),left:0,right:0};return w.createElement("div",{"data-tabid":a.key,className:u,style:d,onMouseDown:this.onMouseDown},this.makeResizeEdge(I.topResizable,this.onTopResizeStart),l.template(o,a.model),this.makeResizeEdge(I.bottomResizable,this.onBottomResizeStart))},t.prototype.makeResizeEdge=function(e,t){var r=_(I.resizableEdge,e,this.state.dragClass);return w.createElement("span",{className:r,onMouseDown:t})},t.prototype.beginDrag=function(e,t,r){0==e.button&&(e.stopPropagation(),document.onmouseup=this.onMouseUp,document.onmousemove=t,r())},t.prototype.getCurrentCellRange=function(e){var t=this.props.config.itemsLayout.pointToInterval(0,e.pageY,this.parent.getBoundingClientRect());return Object(n.L)(t,this.props.surfaceStore,this.props.config.columnProvider)},t.prototype.moveSelection=function(e,t){var r=this.props,o=r.getSelection,n=r.setTimeSelection,i=o(),s=Object(c.x)(i.End,i.Start),a=Object(c.Qb)(i.Start),l=Object(c.h)(Object(c.e)(a,1),-s),u=Object(c.h)(i.Start,e);Object(c.x)(a,u)>0&&(u=a),Object(c.x)(l,u)<0&&(u=l);var d=Object(c.h)(u,s);t.stopPropagation(),t.preventDefault(),n(u,d)},t.prototype.moveDays=function(e,t){var r=this.props,o=r.setTimeSelection,n=r.setDateSelection,i=r.getSelection,s=r.displayDate,a=i(),l=Object(c.e)(a.Start,e),u=Object(c.e)(a.End,e);n(Object(c.e)(s,e)),o(l,u),t.stopPropagation(),t.preventDefault()},t.prototype.onFocus=function(e){var t=this.props,r=t.config,o=t.getSelection,n=t.setTimeSelection,i=o();if(!i.IsAllDayEvent){var s=r.columnProvider.getColumnDate(0);if(!Object(c.Db)(i.Start,s)){var a=Object(c.f)(s,Object(c.nb)(i.Start));a=Object(c.h)(a,Object(c.rb)(i.Start));var l=Object(c.x)(i.End,i.Start);n(a,Object(c.h)(a,l))}}},t=o.__decorate([D.observer],t)}(w.Component),E=r(3805),x=r(3975),C=r(18),k=r(697),R=r(180),H=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onSurfaceClick=function(e,r,o,n){var i=t.props.viewStateHost.schedulingGridViewState.selectionItem,s=Object(c.x)(i.End,i.Start),a=Object(c.u)(i.End,i.Start),l=Object(c.x)(r,e),u=Object(c.h)(e,n||a>0?l:s);t.props.editMode&&t.props.onDateTimesChanged(Object(c.Kb)(i.Start,e),Object(c.Kb)(i.End,u),o),Object(C.o)("SchedulingGridClickEvent",{conflicts:t.getConflictCount({start:e,end:u})>0})},t.onDateTimesChanged=function(e,r){if(t.props.editMode){var o=t.props.viewStateHost.schedulingGridViewState.selectionItem;t.props.onDateTimesChanged(e,Object(c.Kb)(o.End.tz,r),!1)}},t.onOverflowItemClicked=function(e){e.stopPropagation(),Object(n.Z)(t.props.viewStateHost.schedulingGridViewState,!0)},t}return o.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.viewStateHost,r=e.selectionTemplate,o=e.conflictTemplate,s=e.editMode,a=Object(E.a)(t.schedulingGridViewState),c={itemsEventHandlers:null,itemsDecorator:this.itemsDecorator,template:function(e,t,r){return Object(n.Q)(e,t,R.b,s&&Object(i.m)(t),r)}},l={itemsEventHandlers:null,itemsDecorator:this.itemsDecorator,template:function(e,t,r){return Object(n.u)(e,t,R.b,s&&Object(i.m)(t),r)}},d={itemsEventHandlers:null,itemsDecorator:this.itemsDecorator,template:o},b={itemsEventHandlers:null,itemsDecorator:this.selectionDecorator,template:r},p={itemsEventHandlers:{onClick:this.onOverflowItemClicked},itemsDecorator:this.selectionDecorator,template:n.U};return a.getItemConfig=function(e){return Object(n.R)(e.ItemId.Id)?p:Object(u.b)(e)?d:Object(u.c)(e)?b:Object(k.a)(e)?l:c},a.onSurfaceClick=s?this.onSurfaceClick:function(){return null},w.createElement(E.b,{store:t.schedulingGridViewState,config:a,inDayBehaviors:[w.createElement(x.a,{key:"scheduling",viewState:t.schedulingGridViewState}),w.createElement(n.c,{key:"autoscroll"})],renderInDayBehaviors:[w.createElement(z,{key:"gridselection",surfaceStore:t.schedulingGridViewState,config:a,displayDate:t.schedulingGridViewState.selectedDate,getSelection:function(){return t.schedulingGridViewState.selectionItem},setTimeSelection:this.onDateTimesChanged,setDateSelection:this.setDateSelection})],highlightedEventId:"schedulingSelection"})},t.prototype.setDateSelection=function(e){var t=this.props.viewStateHost;Object(m.b)(t,e)},t.prototype.itemsDecorator=function(){return w.createElement("div",{style:{position:"absolute"}})},t.prototype.selectionDecorator=function(){return w.createElement("div",{style:{position:"absolute",zIndex:3}})},t.prototype.getConflictCount=function(e){var t=0;return this.props.viewStateHost.schedulingGridViewState.calendarItems.forEach(function(r){"schedulingSelection"!=r.ItemId.Id&&null!=r.FreeBusyType&&"Free"!=r.FreeBusyType&&(r.IsAllDayEvent?t++:e.start<r.End&&e.end>r.Start&&t++)}),t},t=o.__decorate([D.observer],t)}(w.Component);r.d(t,"ComposeSchedulingGrid",function(){return H}),r.d(t,"initializeSchedulingGrid",function(){return m.a})}},0,[6,7,9,14,142,157,240,514,105,557,335,24,116,173,495]]);
//# sourceMappingURL=owa.SchedulingGrid.js.map
self.scriptsLoaded['owa.SchedulingGrid.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.SchedulingGrid.js'] = (new Date()).getTime();