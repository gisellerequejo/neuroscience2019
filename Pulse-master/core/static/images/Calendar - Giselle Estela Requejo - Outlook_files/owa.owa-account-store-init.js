self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.owa-account-store-init.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[493],{2005:function(t,e,n){"use strict";n.r(e);var r=n(0),i=n(240),c=n(144),o=n(34),u=n(2),a=n(11),s=n(6008),f=n.n(s),d=n(25),l=n(865);Object(u.orchestrator)(i.a,function(t){var e=t.primarySmtpAddress;return r.__awaiter(void 0,void 0,void 0,function(){var t,n,u,s,v;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),t=Object(o.e)(e),[4,Object(c.e)(t)];case 1:return n=r.sent(),u=Object(i.c)(e),n.headers&&u?[4,f()(n)]:[3,4];case 2:return s=r.sent(),Object(d.s)(s,e),a.d.info(e+" initialized."),[4,Object(l.c)(l.a.Outlook,e)];case 3:r.sent(),r.label=4;case 4:return[3,6];case 5:return v=r.sent(),a.d.error(e+" failed to initialize: "+v),[3,6];case 6:return[2]}})})});Object(u.orchestrator)(i.j,function(t){var e=t.primarySmtpAddress;return r.__awaiter(void 0,void 0,void 0,function(){return r.__generator(this,function(t){return Object(d.r)(e),Object(o.i)(e),[2]})})});var v=Object(u.action)("setAccountStoreInitialized",function(t){return{initialized:t}}),b=Object(u.action)("initializeOwaAccountsStore"),j=n(4116),O=n(5),p=n(75),w=n(6),A=Object(u.createStore)("OWAAccountsStoreInitStore",{isAccountsStoreInitialized:!1});function h(t){switch(t.providerType){case j.b.Msa:case j.b.MsaInt:return!0;case j.b.Google:return Object(w.e)("cal-addCalendar-google");case j.b.TeamSnap:return!1;default:return Object(p.a)(t.providerType)}}function y(t){switch(t){case j.b.Msa:return"Outlook";case j.b.Google:return"Google";default:return Object(p.a)(t)}}Object(u.orchestrator)(b,function(){return r.__awaiter(void 0,void 0,void 0,function(){var t,e;return r.__generator(this,function(n){switch(n.label){case 0:return!0===A().isAccountsStoreInitialized?[2]:[4,j.d.importAndExecute()];case 1:return t=n.sent(),(e=t)&&e.filter(h).forEach(function(t){var e=parseInt(t.token.expiresIn);Object(i.a)({primarySmtpAddress:t.userAccount.emailAddress,displayEmail:t.userAccount.emailAddress,accountId:t.userAccount.id,accountUniqueId:t.userAccount.accountUniqueId,anchorMailbox:t.userAccount.routingHint,token:t.token.accessToken,tokenExpiry:Object(O.j)(Object(O.Jb)(),e),accountProviderType:y(t.providerType),isAccountValid:e>0})}),v(!0),[2]}})})}),Object(u.mutator)(v,function(t){var e=t.initialized;A().isAccountsStoreInitialized=e}),n.d(e,"initializeOwaAccountsStore",function(){return b})},357:function(t,e,n){"use strict";e.a=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},4116:function(t,e,n){"use strict";var r=n(3),i=n(4179),c=n(0),o=n(4484);function u(t){return c.__awaiter(this,void 0,void 0,function(){return c.__generator(this,function(e){switch(e.label){case 0:return[4,Object(o.a)(t)];case 1:return[2,e.sent()]}})})}n.d(e,"e",function(){return s}),n.d(e,"d",function(){return f}),n.d(e,"f",function(){return d}),n.d(e,"g",function(){return v}),n.d(e,"b",function(){return i.b}),n.d(e,"a",function(){return i.a}),n.d(e,"c",function(){return u});var a=new r.c(function(){return Promise.all([n.e(587),n.e(496)]).then(n.bind(null,13727))}),s=new r.a(a,function(t){return t.linkAccountAndGetAccessToken}),f=new r.a(a,function(t){return t.getAllConnectedAccounts}),d=(new r.a(a,function(t){return t.getConnectedAccount}),new r.a(a,function(t){return t.addConnectedAccount}),new r.a(a,function(t){return t.removeConnectedAccount})),l=(new r.a(a,function(t){return t.refreshConnectedAccountAccessToken}),new r.a(a,function(t){return t.idpResponseHandler})),v=new r.a(a,function(t){return t.setAddConnectedAccountHandler});"undefined"!=typeof window&&void 0!==window.Owa&&(window.Owa.lazyIdpResponseHandler=l)},4179:function(t,e,n){"use strict";var r,i;n.d(e,"b",function(){return r}),n.d(e,"a",function(){return i}),function(t){t.Msa="Msa",t.TeamSnap="TeamSnap",t.MsaInt="MsaInt",t.Google="Google"}(r||(r={})),function(t){t.Active="Active",t.Revoked="Revoked",t.Error="Error"}(i||(i={}))},422:function(t,e,n){"use strict";var r=n(479).a.Symbol;e.a=r},4484:function(t,e,n){"use strict";n.d(e,"a",function(){return u});var r=n(0),i=n(4),c=n(65),o="ows/beta/ConnectedAccounts/refreshtoken/{0}";function u(t){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,Object(c.c)(Object(i.b)(o,t),null,void 0,!1)];case 1:return[2,e.sent()]}})})}},479:function(t,e,n){"use strict";var r=n(950),i="object"==typeof self&&self&&self.Object===Object&&self,c=r.a||i||Function("return this")();e.a=c},523:function(t,e,n){"use strict";var r=n(357),i=n(848),c=n(892),o="Expected a function",u=Math.max,a=Math.min;e.a=function(t,e,n){var s,f,d,l,v,b,j=0,O=!1,p=!1,w=!0;if("function"!=typeof t)throw new TypeError(o);function A(e){var n=s,r=f;return s=f=void 0,j=e,l=t.apply(r,n)}function h(t){var n=t-b;return void 0===b||n>=e||n<0||p&&t-j>=d}function y(){var t=Object(i.a)();if(h(t))return m(t);v=setTimeout(y,function(t){var n=e-(t-b);return p?a(n,d-(t-j)):n}(t))}function m(t){return v=void 0,w&&s?A(t):(s=f=void 0,l)}function g(){var t=Object(i.a)(),n=h(t);if(s=arguments,f=this,b=t,n){if(void 0===v)return function(t){return j=t,v=setTimeout(y,e),O?A(t):l}(b);if(p)return v=setTimeout(y,e),A(b)}return void 0===v&&(v=setTimeout(y,e)),l}return e=Object(c.a)(e)||0,Object(r.a)(n)&&(O=!!n.leading,d=(p="maxWait"in n)?u(Object(c.a)(n.maxWait)||0,e):d,w="trailing"in n?!!n.trailing:w),g.cancel=function(){void 0!==v&&clearTimeout(v),j=0,s=b=f=v=void 0},g.flush=function(){return void 0===v?l:m(Object(i.a)())},g}},6008:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(56);e.default=function(t){return r.makeServiceRequest("GetOwaUserConfiguration",{},t)}},613:function(t,e,n){"use strict";e.a=function(t){return null!=t&&"object"==typeof t}},645:function(t,e,n){"use strict";var r=n(422),i=Object.prototype,c=i.hasOwnProperty,o=i.toString,u=r.a?r.a.toStringTag:void 0;var a=function(t){var e=c.call(t,u),n=t[u];try{t[u]=void 0;var r=!0}catch(t){}var i=o.call(t);return r&&(e?t[u]=n:delete t[u]),i},s=Object.prototype.toString;var f=function(t){return s.call(t)},d="[object Null]",l="[object Undefined]",v=r.a?r.a.toStringTag:void 0;e.a=function(t){return null==t?void 0===t?l:d:v&&v in Object(t)?a(t):f(t)}},848:function(t,e,n){"use strict";var r=n(479);e.a=function(){return r.a.Date.now()}},871:function(t,e,n){"use strict";var r=n(645),i=n(613),c="[object Symbol]";e.a=function(t){return"symbol"==typeof t||Object(i.a)(t)&&Object(r.a)(t)==c}},892:function(t,e,n){"use strict";var r=n(357),i=n(871),c=NaN,o=/^\s+|\s+$/g,u=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,s=/^0o[0-7]+$/i,f=parseInt;e.a=function(t){if("number"==typeof t)return t;if(Object(i.a)(t))return c;if(Object(r.a)(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Object(r.a)(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(o,"");var n=a.test(t);return n||s.test(t)?f(t.slice(2),n?2:8):u.test(t)?c:+t}},950:function(t,e,n){"use strict";(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.a=n}).call(this,n(101))}},0,[514,105,587,496,24,116,495]]);
//# sourceMappingURL=owa.owa-account-store-init.js.map
self.scriptsLoaded['owa.owa-account-store-init.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.owa-account-store-init.js'] = (new Date()).getTime();