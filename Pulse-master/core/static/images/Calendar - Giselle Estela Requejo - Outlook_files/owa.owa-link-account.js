self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.owa-link-account.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[496],{13727:function(e,t,o){"use strict";o.r(t);var n,r=o(0),s=o(4179),c=o(8838),a=o.n(c),i={name:"Windows live",oauth:{version:2,auth:"https://login.live.com/oauth20_authorize.srf",grant:"https://login.live.com/oauth20_token.srf"},refresh:!1,login:function(e){e.options.force&&(e.qs.prompt="select_account")},logout:function(){return"http://login.live.com/oauth20_logout.srf?ts="+(new Date).getTime()},scope:{},base:"https://apis.live.net/v5.0/"},u={name:"Windows live",oauth:{version:2,auth:"https://login.live-int.com/oauth20_authorize.srf",grant:"https://login.live-int.com/oauth20_token.srf"},refresh:!1,logout:function(){return"http://login.live-int.com/oauth20_logout.srf?ts="+(new Date).getTime()},scope:{basic:""},base:"https://apis.live-int.net/v5.0/"},l={name:"teamsnap",oauth:{version:2,auth:"https://auth.teamsnap.com/oauth/authorize",grant:"https://auth.teamsnap.com/oauth/token",response_type:"code"},refresh:!1,scope:{basic:"read"},scope_delim:" ",base:"https://api.teamsnap.com/v3/"},p={name:"Google",oauth:{version:2,auth:"https://accounts.google.com/o/oauth2/auth",grant:"https://accounts.google.com/o/oauth2/token"},refresh:!1,login:function(e){e.qs.response_type.indexOf("code")>=0&&(e.qs.access_type="offline"),e.qs.response_type.indexOf("id_token")>-1&&(e.qs.nonce=parseInt((1e12*Math.random()).toString(),10).toString(36)),e.options.force&&(e.qs.approval_prompt="force")},scope:{},scope_delim:" ",base:"https://accounts.google.com"},d=o(75);function h(e,t){var o,n,c,a;switch(e){case s.b.Msa:return(o={})[s.b.Msa]=r.__assign({},i,{id:t}),o;case s.b.TeamSnap:return(n={})[s.b.TeamSnap]=r.__assign({},l,{id:t}),n;case s.b.MsaInt:return(c={})[s.b.MsaInt]=r.__assign({},u,{id:t}),c;case s.b.Google:return(a={})[s.b.Google]=r.__assign({},p,{id:t}),a;default:return Object(d.a)(e)}}function f(e,t){return function(e,t){var o=h(e,t);a.a.settings.scope="",a.a.init(o)}(e,t.clientId),a.a.login(e.toString(),t)}var _=((n={})[s.b.Msa]={clientId:"292841",scope:"service::outlook.office.com::MBI_SSL",display:"popup",response_type:"code",oauth_proxy:"",force:!0},n[s.b.TeamSnap]={clientId:"27ce19d16eee291f13ae63dbd1e02e345dea8ea3dbd2c9e8fb7b7340e07dfe43",scope:"read",display:"popup",oauth_proxy:""},n[s.b.MsaInt]={clientId:"292841",scope:"https://outlook.office.com/Owa.AccessAsUser.All offline_access",display:"popup",oauth_proxy:""},n[s.b.Google]={clientId:"445112211283-sk04feuogpcjd3dq8eshrdnr4bpm1sfk.apps.googleusercontent.com",scope:"openid email profile https://www.googleapis.com/auth/calendar https://www.google.com/m8/feeds/ https://mail.google.com https://www.googleapis.com/auth/drive https://www.googleapis.com/auth/user.birthday.read",display:"popup",response_type:"code",oauth_proxy:"",force:!0},n);function g(e){return r.__awaiter(this,void 0,void 0,function(){var t,o;return r.__generator(this,function(n){switch(n.label){case 0:(t=_[e]).redirect_uri=window.location.origin+"/mail/oauthRedirect.html",n.label=1;case 1:return n.trys.push([1,3,,4]),[4,f(e,t)];case 2:return o=n.sent(),[3,4];case 3:return n.sent(),[2,{error:o.error.message}];case 4:return[2,o.authResponse]}})})}var b=o(65),v="ows/beta/ConnectedAccounts";function m(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,Object(b.b)(v,void 0)];case 1:return[2,e.sent()]}})})}var w=o(4),y="ows/beta/ConnectedAccounts/{0}";function A(e){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,Object(b.b)(Object(w.b)(y,e),null)];case 1:return[2,t.sent()]}})})}var k="ows/beta/ConnectedAccounts";function O(e){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,Object(b.d)(k,e,void 0)];case 1:return[2,t.sent()]}})})}var j="ows/beta/ConnectedAccounts/{0}";function C(e){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,Object(b.a)(Object(w.b)(j,e),void 0,void 0,!0)];case 1:return[2,t.sent()]}})})}var I=o(4484),S=o(66),T={};function x(e,t){T[e]=t}function M(e,t){return r.__awaiter(this,void 0,void 0,function(){var o,n,s,c,a,i,u,l;return r.__generator(this,function(r){switch(r.label){case 0:return o=S.parse(e.location.search.substr(1)||e.location.hash.substr(1)),(n=JSON.parse(o.state))&&n.callback&&t&&n.callback in t?(s=n.network,c=h(s,n.client_id)[s],a=c.scope_delim||",",i=n.scope.split(",").join(a),[4,function(e){return T[e]||O}(s)({clientId:n.client_id,code:o.code,providerType:s,responseType:"code",scope:i,redirectUrl:n.redirect_uri})]):[3,2];case 1:u=r.sent();try{l=JSON.stringify(u),function(e,t){if(0!==t.indexOf("_hellojs_"))return function(){throw new Error("Could not execute callback "+t)};return e[t]}(t,n.callback)(l)}catch(e){}r.label=2;case 2:return e.close(),[2]}})})}o.d(t,"linkAccountAndGetAccessToken",function(){return g}),o.d(t,"getAllConnectedAccounts",function(){return m}),o.d(t,"getConnectedAccount",function(){return A}),o.d(t,"addConnectedAccount",function(){return O}),o.d(t,"removeConnectedAccount",function(){return C}),o.d(t,"refreshConnectedAccountAccessToken",function(){return I.a}),o.d(t,"idpResponseHandler",function(){return M}),o.d(t,"setAddConnectedAccountHandler",function(){return x})}},0,[514,105]]);
//# sourceMappingURL=owa.owa-link-account.js.map
self.scriptsLoaded['owa.owa-link-account.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.owa-link-account.js'] = (new Date()).getTime();