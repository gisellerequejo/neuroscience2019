self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.vendors~QuickComposeContents.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[566],{3536:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.info=0]="info",e[e.error=1]="error",e[e.blocked=2]="blocked",e[e.severeWarning=3]="severeWarning",e[e.success=4]="success",e[e.warning=5]="warning",e[e.remove=9e4]="remove"}(r||(r={}))},3642:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3930);t.HtmlSanitizer=r.default;var i=n(3683);t.htmlToDom=i.default,t.splitWithFragment=i.splitWithFragment;var o=n(3682);t.getInheritableStyles=o.default},3681:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign?function(e,t){return Object.assign(t||{},e)}:function(e,t){var n=t||{};if(e)for(var r=0,i=Object.keys(e);r<i.length;r++){var o=i[r];n[o]=e[o]}return n};t.default=r},3682:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="border-spacing,caption-side,color,cursor,direction,empty-cells,font-family,font-size,font-style,font-variant,font-weight,font,letter-spacing,line-height,list-style-image,list-style-position,list-style-type,list-style,orphans,quotes,text-align,text-indent,text-transform,visibility,white-space,widows,word-spacing".split(",");t.default=function(e){var t=e&&e.ownerDocument&&e.ownerDocument.defaultView,n=t&&t.getComputedStyle(e),i={};return r.forEach(function(e){return i[e]=n&&n.getPropertyValue(e)||""}),i}},3683:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="\x3c!--StartFragment--\x3e",i="\x3c!--EndFragment--\x3e";function o(e){var t=e.indexOf(r),n=e.lastIndexOf(i);if(t>=0&&n>=0&&n>=t+r.length){var o=e.substr(0,t),s=e.substr(n+i.length);return[e=e.substring(t+r.length,n),o,s]}return[e,null,null]}t.default=function(e,t,n){var r=(new DOMParser).parseFromString(e||"","text/html");return r&&r.body&&r.body.firstChild?(t&&(n||function(e,t){var n=o(t)[0];e.body.innerHTML=n})(r,e),r):null},t.splitWithFragment=o},3930:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3681),i=n(3682),o=n(3683),s=n(3931),a=function(){function e(e){e=e||{},this.elementCallbacks=r.default(e.elementCallbacks),this.styleCallbacks=s.getStyleCallbacks(e.styleCallbacks),this.attributeCallbacks=r.default(e.attributeCallbacks),this.allowedTags=s.getAllowedTags(e.additionalAllowedTags),this.allowedAttributes=s.getAllowedAttributes(e.additionalAllowAttributes),this.defaultStyleValues=s.getDefaultStyleValues(e.additionalDefaultStyleValues),this.additionalGlobalStyleNodes=e.additionalGlobalStyleNodes||[],this.allowPreserveWhiteSpace=e.allowPreserveWhiteSpace}return e.convertInlineCss=function(t,n){return new e({additionalGlobalStyleNodes:n}).exec(t,!0)},e.sanitizeHtml=function(t,n){var r=new e(n=n||{}),o=n.currentElementOrStyle instanceof HTMLElement?i.default(n.currentElementOrStyle):n.currentElementOrStyle;return r.exec(t,n.convertCssOnly,n.preserveFragmentOnly,o)},e.prototype.exec=function(e,t,n,r){var i=o.default(e,n);return i&&(this.convertGlobalCssToInlineCss(i),t||this.sanitize(i.body,r)),i&&i.body&&i.body.innerHTML||""},e.prototype.sanitize=function(e,t){if(!e)return"";t=r.default(t,i.default(null)),this.processNode(e,t,{})},e.prototype.convertGlobalCssToInlineCss=function(e){for(var t=l(e.querySelectorAll("style")),n=0,r=this.additionalGlobalStyleNodes.reverse().map(function(e){return e.sheet}).concat(t.map(function(e){return e.sheet}).reverse()).filter(function(e){return e});n<r.length;n++)for(var i=r[n],o=function(t){var n=i.cssRules[t],r=n&&n.style?n.style.cssText:null;if(n.type!=CSSRule.STYLE_RULE||!r||!n.selectorText)return"continue";for(var o=0,s=n.selectorText.split(",");o<s.length;o++){var a=s[o];if(a&&a.trim()&&!(a.indexOf(":")>=0))l(e.querySelectorAll(a)).forEach(function(e){return e.setAttribute("style",r+(e.getAttribute("style")||""))})}},s=i.cssRules.length-1;s>=0;s--)o(s);t.forEach(function(e){e.parentNode&&e.parentNode.removeChild(e)})},e.prototype.processNode=function(e,t,n){var i=e.nodeType,o=i==Node.ELEMENT_NODE,s=i==Node.TEXT_NODE,a=e,l=o?a.tagName.toUpperCase():"";if(o&&!this.allowElement(a,l,n)||s&&/^[\r\n]*$/g.test(e.nodeValue)&&!t.insidePRE||!o&&!s)e.parentNode.removeChild(e);else if(s&&!this.allowPreserveWhiteSpace&&"pre"==t["white-space"])e.nodeValue=e.nodeValue.replace(/^ /gm,"Â ").replace(/ {2}/g," Â ");else if(o){var u=r.default(t);this.processAttributes(a,n),this.processCss(a,l,u,n),"PRE"==l&&(u.insidePRE="true");for(var c=a.firstChild,d=void 0;c;c=d)d=c.nextSibling,this.processNode(c,u,n)}},e.prototype.processCss=function(e,t,n,r){var i=this,o=e.getAttributeNode("style");if(o){var s=o.value.split(";"),a=s.filter(function(t){var o;if(!t||""==t.trim()||2!=(o=t.split(":")).length)return!1;var s=o[0].trim().toLowerCase(),a=o[1].trim().toLowerCase(),l=i.styleCallbacks[s],u=null!=n[s],c=(!l||l(a,e,r))&&"inherit"!=a&&a.indexOf("expression")<0&&"-"!=s.substr(0,1)&&i.defaultStyleValues[s]!=a&&(u&&a!=n[s]||!u&&"initial"!=a&&"normal"!=a);return c&&u&&(n[s]=a),c&&(i.allowPreserveWhiteSpace||"white-space"!=s)});s.length!=a.length&&(a.length>0?e.setAttribute("style",a.map(function(e){return e.trim()}).join("; ")):e.removeAttribute("style"))}},e.prototype.processAttributes=function(e,t){for(var n=e.attributes.length-1;n>=0;n--){var r=e.attributes[n],i=r.name.toLowerCase().trim(),o=r.value,s=this.attributeCallbacks[i];s?o=s(o,e,t):this.allowedAttributes.indexOf(i)<0&&(o=null),null==o||o.toLowerCase().indexOf("script:")>=0?e.removeAttribute(i):r.value=o}},e.prototype.allowElement=function(e,t,n){var r=this.elementCallbacks[t];return r?r(e,n):this.allowedTags.indexOf(t)>=0||t.indexOf(":")>0},e}();function l(e){return[].slice.call(e)}t.default=a},3931:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3681),i="BODY,H1,H2,H3,H4,H5,H6,FORM,P,BR,NOBR,HR,ACRONYM,ABBR,ADDRESS,B,BDI,BDO,BIG,BLOCKQUOTE,CENTER,CITE,CODE,DEL,DFN,EM,FONT,I,INS,KBD,MARK,METER,PRE,PROGRESS,Q,RP,RT,RUBY,S,SAMP,SMALL,STRIKE,STRONG,SUB,SUP,TEMPLATE,TIME,TT,U,VAR,WBR,XMP,INPUT,TEXTAREA,BUTTON,SELECT,OPTGROUP,OPTION,LABEL,FIELDSET,LEGEND,DATALIST,OUTPUT,IMG,MAP,AREA,CANVAS,FIGCAPTION,FIGURE,PICTURE,A,NAV,UL,OL,LI,DIR,UL,DL,DT,DD,MENU,MENUITEM,TABLE,CAPTION,TH,TR,TD,THEAD,TBODY,TFOOT,COL,COLGROUP,DIV,SPAN,HEADER,FOOTER,MAIN,SECTION,ARTICLE,ASIDE,DETAILS,DIALOG,SUMMARY,DATA".split(","),o="accept,align,alt,checked,cite,color,cols,colspan,contextmenu,coords,datetime,default,dir,dirname,disabled,download,face,headers,height,hidden,high,href,hreflang,ismap,kind,label,lang,list,low,max,maxlength,media,min,multiple,open,optimum,pattern,placeholder,readonly,rel,required,reversed,rows,rowspan,scope,selected,shape,size,sizes,span,spellcheck,src,srclang,srcset,start,step,style,tabindex,target,title,translate,type,usemap,value,width,wrap".split(","),s={"background-color":"transparent","border-bottom-color":"rgb(0, 0, 0)","border-bottom-style":"none","border-bottom-width":"0px","border-image-outset":"0","border-image-repeat":"stretch","border-image-slice":"100%","border-image-source":"none","border-image-width":"1","border-left-color":"rgb(0, 0, 0)","border-left-style":"none","border-left-width":"0px","border-right-color":"rgb(0, 0, 0)","border-right-style":"none","border-right-width":"0px","border-top-color":"rgb(0, 0, 0)","border-top-style":"none","border-top-width":"0px","outline-color":"transparent","outline-style":"none","outline-width":"0px",overflow:"visible","text-decoration":"none","-webkit-text-stroke-width":"0px","word-wrap":"break-word","margin-left":"0px","margin-right":"0px",padding:"0px","padding-top":"0px","padding-left":"0px","padding-right":"0px","padding-bottom":"0px",border:"0px","border-top":"0px","border-left":"0px","border-right":"0px","border-bottom":"0px","vertical-align":"baseline",float:"none"};function a(){return null}function l(e,t){var n=t.tagName;return!("LI"==n||"DIV"==n)}function u(e){return e.filter(function(e,t,n){return n.indexOf(e)==t})}t.getAllowedTags=function(e){return u(i.concat(e||[])).map(function(e){return e.toUpperCase()})},t.getAllowedAttributes=function(e){return u(o.concat(e||[])).map(function(e){return e.toLocaleLowerCase()})},t.getDefaultStyleValues=function(e){var t=r.default(s);return e&&Object.keys(e).forEach(function(n){var r=e[n];null!=r?t[n]=r:delete t[n]}),t},t.getStyleCallbacks=function(e){var t=r.default(e);return t.position=t.position||a,t.width=t.width||l,t}},4081:function(e,t,n){"use strict";var r=n(1625),i=n(0),o=n(1),s=n(867),a=n(135),l=n(185),u=n(1709),c=n(274),d=n(918),p=n(362),f=n(3536),h=Object(s.a)(),g=function(e){function t(t){var n,r=e.call(this,t)||this;return r.ICON_MAP=((n={})[f.a.info]="Info",n[f.a.warning]="Info",n[f.a.error]="ErrorBadge",n[f.a.blocked]="Blocked2",n[f.a.remove]="Blocked",n[f.a.severeWarning]="Warning",n[f.a.success]="Completed",n),r._onClick=function(e){r.setState({expandSingleLine:!r.state.expandSingleLine})},r.state={labelId:Object(a.c)("MessageBar"),showContent:!1,expandSingleLine:!1},r}return i.__extends(t,e),t.prototype.render=function(){var e=this.props.isMultiline;return this._classNames=this._getClassNames(),e?this._renderMultiLine():this._renderSingleLine()},t.prototype._getActionsDiv=function(){return this.props.actions?o.createElement("div",{className:this._classNames.actions},this.props.actions):null},t.prototype._getDismissDiv=function(){return this.props.onDismiss?o.createElement(d.a,{disabled:!1,className:this._classNames.dismissal,onClick:this.props.onDismiss,iconProps:{iconName:"Clear"},ariaLabel:this.props.dismissButtonAriaLabel}):null},t.prototype._getDismissSingleLine=function(){return this.props.onDismiss?o.createElement("div",{className:this._classNames.dismissSingleLine},this._getDismissDiv()):null},t.prototype._getExpandSingleLine=function(){return!this.props.actions&&this.props.truncated?o.createElement("div",{className:this._classNames.expandSingleLine},o.createElement(d.a,{disabled:!1,className:this._classNames.expand,onClick:this._onClick,iconProps:{iconName:this.state.expandSingleLine?"DoubleChevronUp":"DoubleChevronDown"},ariaLabel:this.props.overflowButtonAriaLabel,"aria-expanded":this.state.expandSingleLine,"aria-controls":this.state.labelId})):null},t.prototype._getIconSpan=function(){return o.createElement("div",{className:this._classNames.iconContainer,"aria-hidden":!0},o.createElement(p.a,{iconName:this.ICON_MAP[this.props.messageBarType],className:this._classNames.icon}))},t.prototype._renderMultiLine=function(){var e=this.props.theme;return o.createElement("div",{style:{background:e.semanticColors.bodyBackground}},o.createElement("div",{className:this._classNames.root},o.createElement("div",{className:this._classNames.content},this._getIconSpan(),this._renderInnerText(),this._getDismissDiv()),this._getActionsDiv()))},t.prototype._renderSingleLine=function(){var e=this.props.theme;return o.createElement("div",{style:{background:e.semanticColors.bodyBackground}},o.createElement("div",{className:this._classNames.root},o.createElement("div",{className:this._classNames.content},this._getIconSpan(),this._renderInnerText(),this._getExpandSingleLine(),this._getActionsDiv(),this._getDismissSingleLine())))},t.prototype._renderInnerText=function(){var e=Object(l.j)(this.props,l.k,["className"]);return o.createElement("div",{className:this._classNames.text,id:this.state.labelId},o.createElement("span",i.__assign({className:this._classNames.innerText,role:"status","aria-live":this._getAnnouncementPriority()},e),o.createElement(u.a,null,o.createElement("span",null,this.props.children))))},t.prototype._getClassNames=function(){var e=this.props,t=e.theme,n=e.className,r=e.messageBarType,i=e.onDismiss,o=e.actions,s=e.truncated,a=e.isMultiline,l=this.state.expandSingleLine;return h(this.props.styles,{theme:t,messageBarType:r||f.a.info,onDismiss:void 0!==i,actions:void 0!==o,truncated:s,isMultiline:a,expandSingleLine:l,className:n})},t.prototype._getAnnouncementPriority=function(){switch(this.props.messageBarType){case f.a.blocked:case f.a.error:case f.a.severeWarning:return"assertive"}return"polite"},t.defaultProps={messageBarType:f.a.info,onDismiss:void 0,isMultiline:!0},t}(c.a),m=n(13),v={root:"ms-MessageBar",error:"ms-MessageBar--error",blocked:"ms-MessageBar--blocked",severeWarning:"ms-MessageBar--severeWarning",success:"ms-MessageBar--success",warning:"ms-MessageBar--warning",multiline:"ms-MessageBar-multiline",singleline:"ms-MessageBar-singleline",dismissalSingleLine:"ms-MessageBar-dismissalSingleLine",expandingSingleLine:"ms-MessageBar-expandingSingleLine",content:"ms-MessageBar-content",iconContainer:"ms-MessageBar-icon",text:"ms-MessageBar-text",innerText:"ms-MessageBar-innerText",dismissSingleLine:"ms-MessageBar-dismissSingleLine",expandSingleLine:"ms-MessageBar-expandSingleLine",dismissal:"ms-MessageBar-dismissal",expand:"ms-MessageBar-expand",actions:"ms-MessageBar-actions",actionsSingleline:"ms-MessageBar-actionsSingleLine"},y=function(e,t,n){switch(e){case f.a.error:case f.a.blocked:return n.errorBackground;case f.a.severeWarning:return n.blockingBackground;case f.a.success:return n.successBackground;case f.a.warning:return n.warningBackground}return t.neutralLighter},b=function(e,t,n){switch(e){case f.a.error:case f.a.blocked:case f.a.severeWarning:return n.errorText;case f.a.success:return t.green;case f.a.warning:return n.warningText}return t.neutralSecondary};n.d(t,"a",function(){return E});var E=Object(r.a)(g,function(e){var t,n,r,o,s,a=e.theme,l=e.className,u=e.messageBarType,c=e.onDismiss,d=e.truncated,p=e.isMultiline,h=e.expandSingleLine,g=a.semanticColors,E=a.palette,L=a.fonts,C=Object(m.getScreenSelector)(0,m.ScreenWidthMaxSmall),w=Object(m.getGlobalClassNames)(v,a),S={flexShrink:0,width:32,height:32,padding:"8px 12px",selectors:{"& .ms-Button-icon":{fontSize:m.IconFontSizes.xSmall,height:10,lineHeight:"10px",color:E.neutralPrimary,selectors:(t={},t[m.HighContrastSelector]={MsHighContrastAdjust:"none",color:"Window"},t)},":hover":{backgroundColor:"transparent"},":active":{backgroundColor:"transparent"}}};return{root:[w.root,a.fonts.medium,u===f.a.error&&w.error,u===f.a.blocked&&w.blocked,u===f.a.severeWarning&&w.severeWarning,u===f.a.success&&w.success,u===f.a.warning&&w.warning,p?w.multiline:w.singleline,!p&&c&&w.dismissalSingleLine,!p&&d&&w.expandingSingleLine,{background:y(u,E,g),color:E.neutralPrimary,minHeight:32,width:"100%",display:"flex",wordBreak:"break-word",selectors:(n={"& .ms-Link":i.__assign({color:E.themeDark},L.small)},n[m.HighContrastSelector]={background:"WindowText",color:"Window"},n)},p&&{flexDirection:"column"},l],content:[w.content,{display:"flex",width:"100%",lineHeight:"normal"}],iconContainer:[w.iconContainer,{fontSize:m.IconFontSizes.medium,minWidth:16,minHeight:16,display:"flex",flexShrink:0,margin:"8px 0 8px 12px"}],icon:{color:b(u,E,g),selectors:(r={},r[m.HighContrastSelector]={MsHighContrastAdjust:"none",color:"Window"},r)},text:[w.text,i.__assign({minWidth:0,display:"flex",flexGrow:1,margin:8},L.small,{selectors:(o={},o[m.HighContrastSelector]={MsHighContrastAdjust:"none"},o)}),!c&&{marginRight:12}],innerText:[w.innerText,{lineHeight:16,selectors:{"& span a":{paddingLeft:4}}},d&&{overflow:"visible",whiteSpace:"pre-wrap"},!p&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},!p&&!d&&{selectors:(s={},s[C]={overflow:"visible",whiteSpace:"pre-wrap"},s)},h&&{overflow:"visible",whiteSpace:"pre-wrap"}],dismissSingleLine:[w.dismissSingleLine],expandSingleLine:[w.expandSingleLine],dismissal:[w.dismissal,S],expand:[w.expand,S],actions:[p?w.actions:w.actionsSingleline,{display:"flex",flexGrow:0,flexShrink:0,flexBasis:"auto",flexDirection:"row-reverse",alignItems:"center",margin:"0 12px 0 8px",selectors:{"& button:nth-child(n+2)":{marginLeft:8}}},p&&{marginBottom:8},c&&!p&&{marginRight:0}]}},void 0,{scope:"MessageBar"})},4536:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3458);t.getDefaultContentEditFeatures=function(){return{autoLink:!0,indentWhenTab:!0,outdentWhenShiftTab:!0,outdentWhenBackspaceOnEmptyFirstLine:!0,outdentWhenEnterOnEmptyLine:r.Browser.isIE,mergeInNewLineWhenBackspaceOnFirstChar:!1,unquoteWhenBackspaceOnEmptyFirstLine:!0,unquoteWhenEnterOnEmptyLine:!0,autoBullet:!0,tabInTable:!0,upDownInTable:r.Browser.isChrome||r.Browser.isSafari,insertLineBeforeStructuredNodeFeature:!1,defaultShortcut:!0,unlinkWhenBackspaceAfterLink:!1,smartOrderedList:!1,smartOrderedListStyles:["lower-alpha","lower-roman","decimal"]}}},4537:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="NodeId";function i(e,t){var n=t.getAttribute(r);return n||(n=e.nextNodeId.toString(),e.nextNodeId++,t.setAttribute(r,n)),n}t.createCustomData=function(){return{dict:{},nextNodeId:1}},t.setObject=function(e,t,n,r){if(1==t.nodeType){var o=i(e,t);""!=o&&(e.dict[o]||(e.dict[o]={}),e.dict[o][n]=r)}},t.getObject=function(e,t,n){if(1==t.nodeType){var r=i(e,t);if(""!=r)return e.dict[r]&&e.dict[r][n]}return null}},4538:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createLevelLists=function(){return{listsMetadata:{},currentUniqueListId:-1}}},5230:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5231);t.HyperLink=r.default;var i=n(5232);t.ContentEdit=i.default;var o=n(5239);t.Paste=o.default;var s=n(4536);t.getDefaultContentEditFeatures=s.getDefaultContentEditFeatures;var a=n(5248);t.Watermark=a.default;var l=n(5249);t.TableResize=l.default;var u=n(5250);t.CustomReplace=u.default},5231:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3458),i=function(){function e(e,t,n){var r=this;void 0===e&&(e=function(e){return e}),this.getTooltipCallback=e,this.target=t,this.onLinkClick=n,this.onMouse=function(e){var t=r.editor.getElementAtCursor("a[href]",e.target),n=r.tryGetHref(t);n&&r.editor.setEditorDomAttribute("title","mouseover"==e.type?r.getTooltipCallback(n,t):null)}}return e.prototype.getName=function(){return"Hyperlink"},e.prototype.initialize=function(e){this.editor=e,this.disposer=this.getTooltipCallback&&e.addDomEventHandler({mouseover:this.onMouse,mouseout:this.onMouse})},e.prototype.dispose=function(){this.disposer&&(this.disposer(),this.disposer=null),this.editor=null},e.prototype.onPluginEvent=function(e){if(5==e.eventType){var t=this.editor.getElementAtCursor("A",e.rawEvent.srcElement);if(t){if(this.onLinkClick&&!1!==this.onLinkClick(t,e.rawEvent))return;var n=void 0;if(!r.Browser.isFirefox&&(n=this.tryGetHref(t))&&(r.Browser.isMac?e.rawEvent.metaKey:e.rawEvent.ctrlKey)&&0===e.rawEvent.button)try{var i=this.target||"_blank";this.editor.getDocument().defaultView.open(n,i)}catch(e){}}}},e.prototype.tryGetHref=function(e){try{return e?e.href:null}catch(e){}},e}();t.default=i},5232:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4536),i=n(5233),o=n(5234),s=n(5235),a=n(5236),l=n(5237),u=n(5238),c=function(){function e(e){this.featureSet=e}return e.prototype.getName=function(){return"ContentEdit"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.getFilteredFeatures().forEach(function(e){return t.editor.addContentEditFeature(e)})},e.prototype.dispose=function(){this.editor=null},e.prototype.getFilteredFeatures=function(){var e=this.featureSet||r.getDefaultContentEditFeatures(),t={indentWhenTab:l.IndentWhenTab,outdentWhenShiftTab:l.OutdentWhenShiftTab,outdentWhenBackspaceOnEmptyFirstLine:l.OutdentWhenBackOn1stEmptyLine,outdentWhenEnterOnEmptyLine:l.OutdentWhenEnterOnEmptyLine,mergeInNewLineWhenBackspaceOnFirstChar:l.MergeInNewLine,unquoteWhenBackspaceOnEmptyFirstLine:u.UnquoteWhenBackOnEmpty1stLine,unquoteWhenEnterOnEmptyLine:u.UnquoteWhenEnterOnEmptyLine,tabInTable:a.TabInTable,upDownInTable:a.UpDownInTable,insertLineBeforeStructuredNodeFeature:s.InsertLineBeforeStructuredNodeFeature,autoBullet:l.AutoBullet,autoLink:i.AutoLink,unlinkWhenBackspaceAfterLink:i.UnlinkWhenBackspaceAfterLink,defaultShortcut:o.DefaultShortcut,smartOrderedList:l.getSmartOrderedList(e.smartOrderedListStyles)};return Object.keys(t).filter(function(t){return e[t]}).map(function(e){return t[e]})},e}();t.default=c},5233:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3458),i=n(3469),o=n(3568),s=/[.+=\s:;"',>]+$/i,a=5;function l(e,t){return 0==e.eventType||6==e.eventType&&"Paste"==e.source?o.cacheGetEventData(e,"LINK_DATA",function(){var n=6==e.eventType&&"Paste"==e.source&&e.data,i=r.matchLink((n.text||"").trim()),l=o.cacheGetContentSearcher(e,t);if(i&&l.getRangeFromText(i.originalUrl,!1))return i;var u=l&&l.getWordBefore();if(u&&u.length>a){var c=(u.match(s)||[])[0]||"",d=u.substring(0,u.length-c.length);return["()","{}","[]"].forEach(function(e){d[d.length-1]==e[1]&&d.indexOf(e[0])<0&&(d=d.substr(0,d.length-1))}),r.matchLink(d)}return null}):null}t.AutoLink={keys:[13,32,2048],shouldHandleEvent:l,handleEvent:function(e,t){var n=t.getDocument().createElement("a"),r=l(e,t),s=t.getContentSearcherOfCursor();n.textContent=r.originalUrl,n.href=r.normalizedUrl,t.runAsync(function(){t.performAutoComplete(function(){return i.replaceWithNode(t,r.originalUrl,n,!1,s),o.clearContentSearcherCache(e),n},"AutoLink")})}},t.UnlinkWhenBackspaceAfterLink={keys:[8],shouldHandleEvent:function(e,t){return o.cacheGetContentSearcher(e,t).getInlineElementBefore()instanceof r.LinkInlineElement},handleEvent:function(e,t){e.rawEvent.preventDefault(),i.removeLink(t)}}},5234:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3458),i=n(3568),o=n(3469);function s(e,t,n){return{winKey:e,macKey:t,action:n}}var a=[s(322,578,o.toggleBold),s(329,585,o.toggleItalic),s(341,597,o.toggleUnderline),s(346,602,function(e){return e.undo()}),s(345,1626,function(e){return e.redo()}),s(446,702,o.toggleBullet),s(447,703,o.toggleNumbering),s(1470,1726,function(e){return o.changeFontSize(e,0)}),s(1468,1724,function(e){return o.changeFontSize(e,1)})];function l(e){return i.cacheGetEventData(e,"DEFAULT_SHORT_COMMAND",function(){var t=e.rawEvent,n=0!=e.eventType||t.altKey?0:t.which|(t.metaKey&&512)|(t.shiftKey&&1024)|(t.ctrlKey&&256);return n&&a.filter(function(e){return(r.Browser.isMac?e.macKey:e.winKey)==n})[0]})}t.DefaultShortcut={allowFunctionKeys:!0,keys:[66,73,85,89,90,188,190,191],shouldHandleEvent:l,handleEvent:function(e,t){var n=l(e);n&&(n.action(t),e.rawEvent.preventDefault(),e.rawEvent.stopPropagation())}}},5235:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3568),i=n(3458),o=i.Browser.isEdge?"<div><span><br></span></div>":"<div><br></div>",s={TD:"TABLE",TH:"TABLE",LI:"OL,UL"},a=Object.keys(s).join(",");function l(e,t){return r.cacheGetEventData(e,"FIRST_STRUCTURE",function(){var n=e.rawEvent.shiftKey?null:t.getElementAtCursor(a);if(n){var r=t.getSelectionRange();if(r&&r.collapsed&&i.isPositionAtBeginningOf(i.Position.getStart(r),n)&&!t.getBodyTraverser(n).getPreviousBlockElement())return t.getElementAtCursor(s[i.getTagOfNode(n)])}return null})}t.InsertLineBeforeStructuredNodeFeature={keys:[13],shouldHandleEvent:l,handleEvent:function(e,t){var n=l(e,t),r=i.fromHtml(o,t.getDocument())[0];t.addUndoSnapshot(function(){n.parentNode.insertBefore(r,n),"TABLE"==i.getTagOfNode(n)&&t.select(new i.Position(r,0).normalize())}),e.rawEvent.preventDefault()}}},5236:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3568),i=n(3458);function o(e,t){return r.cacheGetEventData(e,"TABLECELL_FOR_TABLE_FEATURES",function(){var e=t.getFocusedPosition(),n=t.getElementAtCursor("TD,TH,LI",e.node);return"LI"==i.getTagOfNode(n)?null:n})}t.TabInTable={keys:[9],shouldHandleEvent:o,handleEvent:function(e,t){for(var n=e.rawEvent.shiftKey,r=o(e,t),s=new i.VTable(r),a=n?-1:1,l=s.row,u=s.col+a;;u+=a){if(u<0||u>=s.cells[l].length){if((l+=a)<0||l>=s.cells.length){t.select(s.table,n?-2:-3);break}u=n?s.cells[l].length-1:0}var c=s.getCell(l,u);if(c.td){t.select(c.td,0);break}}e.rawEvent.preventDefault()}},t.UpDownInTable={keys:[38,40],shouldHandleEvent:o,handleEvent:function(e,t){for(var n=o(e,t),r=new i.VTable(n),s=38==e.rawEvent.which,a=s?-1:1,l=null,u=e.rawEvent.shiftKey,c=t.getSelection(),d=c.anchorNode,p=c.anchorOffset,f=r.row;f>=0&&f<r.cells.length;f+=a){var h=r.getCell(f,r.col);if(h.td&&h.td!=n){l=h.td;break}}t.runAsync(function(){var e=t.getElementAtCursor();if(i.contains(r.table,e)&&!i.contains(n,e,!0)){var o=l?new i.Position(l,0):new i.Position(r.table,s?-2:-3);u?(o=1==o.node.nodeType&&i.isVoidHtmlElement(o.node)?new i.Position(o.node,o.isAtEnd?-3:-2):o,t.getSelection().setBaseAndExtent(d,p,o.node,o.offset)):t.select(o)}})}}},5237:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3469),i=n(3568),o=n(3458);function s(e,t){var n=a(e,t);if(n){var i=n[0],s=o.getTagOfNode(i);"UL"==s?r.toggleBullet(t):"OL"==s&&r.toggleNumbering(t),t.focus(),e.rawEvent.preventDefault()}}function a(e,t){var n=i.cacheGetElementAtCursor(t,e,"LI,TABLE"),r=n&&"LI"==o.getTagOfNode(n)&&t.getElementAtCursor("UL,OL",n);return r?[r,n]:null}t.IndentWhenTab={keys:[9],shouldHandleEvent:function(e,t){return!e.rawEvent.shiftKey&&a(e,t)},handleEvent:function(e,t){r.setIndentation(t,0),e.rawEvent.preventDefault()}},t.OutdentWhenShiftTab={keys:[9],shouldHandleEvent:function(e,t){return e.rawEvent.shiftKey&&a(e,t)},handleEvent:function(e,t){r.setIndentation(t,1),e.rawEvent.preventDefault()}},t.MergeInNewLine={keys:[8],shouldHandleEvent:function(e,t){var n=i.cacheGetElementAtCursor(t,e,"LI"),r=t.getSelectionRange();return n&&r&&o.isPositionAtBeginningOf(o.Position.getStart(r),n)},handleEvent:function(e,t){i.cacheGetElementAtCursor(t,e,"LI").previousSibling?t.runAsync(function(){var e=t.getDocument().createElement("BR");t.insertNode(e),t.select(e,-3)}):s(e,t)}},t.OutdentWhenBackOn1stEmptyLine={keys:[8],shouldHandleEvent:function(e,t){var n=i.cacheGetElementAtCursor(t,e,"LI");return n&&o.isNodeEmpty(n)&&!n.previousSibling},handleEvent:s},t.OutdentWhenEnterOnEmptyLine={keys:[13],shouldHandleEvent:function(e,t){var n=i.cacheGetElementAtCursor(t,e,"LI");return!e.rawEvent.shiftKey&&n&&o.isNodeEmpty(n)},handleEvent:function(e,t){t.performAutoComplete(function(){return s(e,t)})}},t.AutoBullet={keys:[32],shouldHandleEvent:function(e,t){if(!a(e,t)){var n=i.cacheGetContentSearcher(e,t),r=n.getSubStringBefore(3);return["*","-","1."].indexOf(r)>=0&&!n.getNearestNonTextInlineElement()}return!1},handleEvent:function(e,t){t.runAsync(function(){t.performAutoComplete(function(){var e=t.getContentSearcherOfCursor(),n=e.getSubStringBefore(3),i=e.getRangeFromText(n,!0);i&&i.deleteContents();var s=t.getDocument().createElement("BR");(o.Browser.isChrome||o.Browser.isSafari||o.Browser.isIE11OrGreater)&&t.insertNode(s),0==n.indexOf("1.")?r.toggleNumbering(t):r.toggleBullet(t),t.deleteNode(s)})})}},t.getSmartOrderedList=function(e){return{keys:[2048],shouldHandleEvent:function(e,t){return e.data instanceof HTMLOListElement},handleEvent:function(t,n){var r=t.data,i=n.getElementAtCursor("OL",r.parentNode);if(i){var o=e&&e.length>0?e:["decimal"];r.style.listStyle=o[(o.indexOf(i.style.listStyle)+1)%o.length]}}}}},5238:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3568),i=n(3458),o="BLOCKQUOTE",s=[o,"LI","TD","TH"].join(",");function a(e,t){return r.cacheGetEventData(e,"QUOTE_CHILD",function(){var e=t.getElementAtCursor(s);if(e&&i.getTagOfNode(e)==o){var n=t.getFocusedPosition(),r=n&&t.getBlockElementAtNode(n.normalize().node);if(r){var a=r.getStartNode()==e?r.getStartNode():r.collapseToSingleElement();return i.isNodeEmpty(a)?a:null}}return null})}function l(e,t){t.addUndoSnapshot(function(){var n,r=a(e,t);i.getTagOfNode(r)==o&&(r=i.wrap([].slice.call(r.childNodes))),n=i.splitBalancedNodeRange(r),i.unwrap(n),t.select(r,0)}),e.rawEvent.preventDefault()}t.UnquoteWhenBackOnEmpty1stLine={keys:[8],shouldHandleEvent:function(e,t){var n=a(e,t);return n&&i.isNodeEmpty(n)&&!n.previousSibling},handleEvent:l},t.UnquoteWhenEnterOnEmptyLine={keys:[13],shouldHandleEvent:function(e,t){var n=a(e,t);return!e.rawEvent.shiftKey&&n&&i.isNodeEmpty(n)},handleEvent:function(e,t){return t.performAutoComplete(function(){return l(e,t)})}}},5239:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5240),i=n(5241),o=n(5247),s=n(3469),a=n(3469),l=n(3642),u=n(3458),c=function(){function e(e,t){var n=this;this.onPaste=function(e){r.default(e,n.editor,function(e){n.pasteOriginal({snapshotBeforePaste:null,originalFormat:n.getCurrentFormat(),types:e.types,image:e.image,text:e.text,rawHtml:e.html,html:e.html?n.sanitizeHtml(e.html):o.default(e.text)})})},this.applyFormatting=function(e,t){return function(n){u.applyFormat(n,e,t)}},this.sanitizer=new l.HtmlSanitizer({attributeCallbacks:t})}return e.prototype.getName=function(){return"Paste"},e.prototype.initialize=function(e){this.editor=e,this.pasteDisposer=e.addDomEventHandler("paste",this.onPaste)},e.prototype.dispose=function(){this.pasteDisposer(),this.pasteDisposer=null,this.editor=null},e.prototype.pasteOriginal=function(e){this.paste(e,this.detectPasteOption(e))},e.prototype.pasteText=function(e){this.paste(e,1)},e.prototype.pasteAndMergeFormat=function(e){this.paste(e,this.detectPasteOption(e),!0)},e.prototype.detectPasteOption=function(e){return e.text||!e.image?0:2},e.prototype.paste=function(e,t,n){var r=this.editor.getDocument(),i=r.createDocumentFragment();if(0==t)for(var o=e.html,s=0,a=u.fromHtml(o,r);s<a.length;s++){var l=a[s];n&&this.applyToElements(l,this.applyFormatting(e.originalFormat,this.editor.isDarkMode())),i.appendChild(l)}var c=this.editor.triggerPluginEvent(8,{clipboardData:e,fragment:i,pasteOption:t},!0);this.internalPaste(c)},e.prototype.internalPaste=function(e){var t=this,n=e.clipboardData,r=e.fragment,i=e.pasteOption;this.editor.focus(),this.editor.addUndoSnapshot(function(){switch(null==n.snapshotBeforePaste?n.snapshotBeforePaste=t.editor.getContent(!1,!0):t.editor.setContent(n.snapshotBeforePaste),i){case 0:t.editor.insertNode(r);break;case 1:var e=o.default(n.text);t.editor.insertContent(e);break;case 2:a.insertImage(t.editor,n.image)}return n},"Paste")},e.prototype.applyToElements=function(e,t){for(var n=u.getFirstLeafNode(e),r=[];n;)3==n.nodeType&&n.parentNode&&r.indexOf(n.parentNode)<0&&r.push(n.parentNode),n=u.getNextLeafSibling(e,n);r.push(e);for(var i=0,o=r;i<o.length;i++){t(o[i])}},e.prototype.getCurrentFormat=function(){var e=s.getFormatState(this.editor);return e?{fontFamily:e.fontName,fontSize:e.fontSize,textColor:e.textColor,backgroundColor:e.backgroundColor,bold:e.isBold,italic:e.isItalic,underline:e.isUnderline}:{}},e.prototype.sanitizeHtml=function(e){var t=l.htmlToDom(e,!0,i.default);if(t&&t.body){this.sanitizer.convertGlobalCssToInlineCss(t);var n=this.editor.getSelectionRange(),r=n&&u.Position.getStart(n).normalize().element,o=l.getInheritableStyles(r);return this.sanitizer.sanitize(t.body,o),t.body.innerHTML}return""},e}();t.default=c},5240:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3458),i='<div contenteditable style="width: 1px; height: 1px; overflow: hidden; position: fixed; top: 0; left; 0; -webkit-user-select: text"></div>';t.default=function(e,t,n){r.extractClipboardEvent(e,function(e){void 0===e.html?function(e,t){var n=e.getSelectionRange(),o=function(e){var t=e.getCustomData("PasteDiv",function(){var t=r.fromHtml(i,e.getDocument())[0];return e.insertNode(t,{position:4,updateCursor:!1,replaceSelection:!1,insertOnNewLine:!1}),t},function(e){e.parentNode.removeChild(e)});return t.style.display="",t}(e);o.focus(),e.runAsync(function(){e.select(n),t(o.innerHTML),o.style.display="none",o.innerHTML=""})}(t,function(t){e.html=t,n(e)}):n(e)})}},5241:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5242),i=n(5243),o=n(3458),s=n(3642),a="xmlns:w",l="urn:schemas-microsoft-com:office:word",u="xmlns:x",c="urn:schemas-microsoft-com:office:excel",d=/<\/\s*td\s*>((?!<\/\s*tr\s*>)[\s\S])*$/i,p=/<\/\s*tr\s*>((?!<\/\s*table\s*>)[\s\S])*$/i,f=/<tr[^>]*>[^<]*/i,h=/<table[^>]*>[^<]*/i;t.default=function(e,t){var n=s.splitWithFragment(t),g=n[0],m=n[1],v=e&&e.body&&e.querySelector("html");if("HTML"==o.getTagOfNode(v))if(v.getAttribute(a)==l)e.body.innerHTML=g,i.default(e);else if(v.getAttribute(u)==c){if(g.match(d)){var y=m.match(f);g=(y?y[0]:"<TR>")+g+"</TR>"}if(g.match(p)){var b=m.match(h);g=(b?b[0]:"<TABLE>")+g+"</TABLE>"}e.body.innerHTML=g,r.default(e)}else e.body.innerHTML=g}},5242:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3642);t.default=function(e){var t=new r.HtmlSanitizer({styleCallbacks:{border:function(e,t){return"none"!=e||"none"!=t.style.border}},additionalAllowAttributes:["class"]});t.sanitize(e.body);var n=e.createElement("style");e.body.appendChild(n),n.innerHTML="td {border: solid 1px #d4d4d4}",t.convertGlobalCssToInlineCss(e)}},5243:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5244),i=n(5245),o=n(3642),s=n(5246);t.default=function(e){var t;new o.HtmlSanitizer({elementCallbacks:(t={},t["O:P"]=function(){return!1},t),additionalAllowAttributes:["class"]}).sanitize(e.body);var n=r.createWordConverter(),a=e.querySelectorAll("p");a.length>0&&(n.wordConverterArgs=i.createWordConverterArguments(a),s.processNodesDiscovery(n)&&s.processNodeConvert(n))}},5244:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4537);t.createWordConverter=function(){return{nextUniqueId:1,numBulletsConverted:0,numNumberedConverted:0,wordConverterArgs:null,customData:r.createCustomData()}}},5245:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4538);t.createWordConverterArguments=function(e){return{nodes:e,currentIndex:0,lists:{},listItems:[],currentListIdsByLevels:[r.createLevelLists()],lastProcessedItem:null}}},5246:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4538),i=n(4537),o=n(3458),s=5,a="UniqueListId",l="mso-list",u=/[\n|\r]/gi;function c(e,t,n,r){var s=function e(t,n,r){var i=null;var s;1==n?s=m(t):(i=e(t,n-1,null),s=i.lastChild);if(s&&1==s.nodeType){var a=o.getTagOfNode(s);if("UL"==a||"OL"==a)return s}var l=t.ownerDocument.createElement(r?r.tagName:"UL");1==n?t.parentNode.insertBefore(l,t):i.appendChild(l);return l}(t,n.level,r),l=i.getObject(e.customData,s,a);if(l&&l!=n.uniqueListId||!l&&s.firstChild){var u=t.ownerDocument.createElement(r.tagName);s.parentNode.insertBefore(u,s.nextSibling),s=u}return i.setObject(e.customData,s,a,n.uniqueListId),function(e,t,n){if(n.tagName!=o.getTagOfNode(t)){var r=t.ownerDocument.createElement(n.tagName);for(i.setObject(e.customData,r,a,i.getObject(e.customData,t,a));t.firstChild;)r.appendChild(t.firstChild);t.parentNode.insertBefore(r,t),t.parentNode.removeChild(t),t=r}return t}(e,s,r)}function d(e,t){for(var n=[],r=e.firstChild;r;r=r.nextSibling)1==r.nodeType&&t>1&&d(r,t-1),(b(r=g(r,!0))||y(r))&&n.push(r);n.forEach(function(t){return e.removeChild(t)})}function p(e){if(1==e.nodeType){var t=E(e,l);if(t&&t.length>0)try{var n=t.split(" ");if(3==n.length)return{level:parseInt(n[1].substr("level".length)),wordListId:t,originalNode:e,uniqueListId:0}}catch(e){}}return null}function f(e){return["o","Â·","Â§","-"].indexOf(e)>=0}function h(e,t){for(var n=null,r=e.firstChild;!n&&r;)y(r=g(r,!0))?0==(n=r.textContent.trim()).length&&(n="o"):1==r.nodeType&&t>1&&(n=h(r,t-1)),r=r.nextSibling;return n}function g(e,t){if(8==e.nodeType){var n=e.data;if(n&&"[if !supportlists]"==n.trim().toLowerCase()){for(var r=e,i=null,o=0;o<4&&(r=v(r));o++)if(8==r.nodeType&&(n=r.data)&&"[endif]"==n.trim().toLowerCase()){i=r;break}if(i){var s=e.ownerDocument.createElement("span");for(s.setAttribute("style","mso-list: ignore"),r=v(e);r!=i;)r=r.nextSibling,s.appendChild(r.previousSibling);i.parentNode.insertBefore(s,i),t&&(e.parentNode.removeChild(e),i.parentNode.removeChild(i)),e=s}}}return e}function m(e){var t=e;do{t=t.previousSibling}while(t&&L(t));return t}function v(e){var t=e;do{t=t.nextSibling}while(t&&L(t));return t}function y(e){if(1==e.nodeType){var t=E(e,l);if(t&&t.length>0&&"ignore"==t.trim().toLowerCase())return!0}return!1}function b(e){return"SPAN"==o.getTagOfNode(e)&&!e.firstChild}function E(e,t){var n=e.getAttribute("style");if(n&&n.length>0&&n.indexOf(t)>=0)for(var r=n.split(";"),i=0;i<r.length;i++){var o=r[i].split(":");if(2==o.length&&o[0].trim()==t)return o[1].trim()}return null}function L(e){if(!e)return!0;if(3==e.nodeType){var t=e.nodeValue;return 0==(t=t.replace(u,"")).trim().length}var n=o.getTagOfNode(e);return e.firstChild==e.lastChild&&("SPAN"==n||"FONT"==n)&&L(e.firstChild)}function C(e){for(var t=0;t<e.currentListIdsByLevels.length;t++){var n=e.currentListIdsByLevels[t];n&&(n.currentUniqueListId=-1)}}t.processNodesDiscovery=function(e){for(var t,n=e.wordConverterArgs;n.currentIndex<n.nodes.length;){var i=n.nodes.item(n.currentIndex),o=p(i);if(o){var a=n.currentListIdsByLevels[o.level-1]||r.createLevelLists();n.currentListIdsByLevels[o.level-1]=a,n.lastProcessedItem&&m(i)!=n.lastProcessedItem&&C(n);var l=a.listsMetadata[o.wordListId];if(l){if(!l.ignore&&1==l.numberOfItems){var u=h(i,s);l.tagName=l.firstFakeBullet==u?"UL":"OL"}}else{var c=h(i,s);l={numberOfItems:0,uniqueListId:e.nextUniqueId++,firstFakeBullet:c,ignore:!c||0==c.length,tagName:(t=c,f(t)?"UL":"OL")},a.listsMetadata[o.wordListId]=l,n.lists[l.uniqueListId.toString()]=l}o.uniqueListId=l.uniqueListId,l.ignore||"OL"==l.tagName&&l.numberOfItems>0&&a.currentUniqueListId!=o.uniqueListId?(l.ignore=!0,n.currentListIdsByLevels[0].currentUniqueListId=-1,n.currentListIdsByLevels=n.currentListIdsByLevels.slice(0,1)):(n.currentListIdsByLevels.length>o.level&&(n.currentListIdsByLevels=n.currentListIdsByLevels.slice(0,o.level)),a.currentUniqueListId=o.uniqueListId,n.listItems.push(o),l.numberOfItems++),n.lastProcessedItem=i}else{var d=n.lastProcessedItem;if(d&&m(i)==d&&i.tagName==d.tagName&&i.className==d.className){for(d.appendChild(d.ownerDocument.createElement("br")),d.appendChild(d.ownerDocument.createElement("br"));null!=i.firstChild;)d.appendChild(i.firstChild);i.parentNode.removeChild(i)}}n.currentIndex++}return n.listItems.length>0},t.processNodeConvert=function(e){var t=e.wordConverterArgs;for(t.currentIndex=0;t.currentIndex<t.listItems.length;){var n=t.listItems[t.currentIndex],r=n.originalNode,i=t.lists[n.uniqueListId.toString()];if(!i.ignore){var o=c(e,r,n,i);if(o){d(r,s);for(var a=r.ownerDocument.createElement("LI");r.firstChild;)a.appendChild(r.firstChild);o.appendChild(a),r.parentNode.removeChild(r),"UL"==i.tagName?e.numBulletsConverted++:e.numNumberedConverted++}}t.currentIndex++}return e.numBulletsConverted>0||e.numNumberedConverted>0}},5247:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3458),i="&#8203;";t.default=function(e){var t=(e=(e||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;").replace(/^ /gm,"&nbsp;").replace(/\r/g,"")).split("\n");if(2==t.length)e="<span>"+t[0]+"<br></span><span>"+t[1]+"</span>";else if(t.length>2){e="";var n=r.Browser.isIEOrEdge?i:"<br>";t.forEach(function(r,i){0==i?e+="<span>"+r+"<br></span>":i==t.length-1?e+="<span>"+r+"</span>":e+="<div>"+r+n+"</div>"})}return e=e.replace(/\s\s/g," &nbsp;")}},5248:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3458),i=new RegExp("<span[^>]*id=['\"]?_rooster_watermarkSpan['\"]?[^>]*>[^<]*</span>","ig"),o=function(){function e(e,t){var n=this;this.watermark=e,this.format=t,this.handleWatermark=function(){n.showHideWatermark(!1)},this.format=this.format||{fontSize:"14px",textColor:"#aaa"}}return e.prototype.getName=function(){return"Watermark"},e.prototype.initialize=function(e){this.editor=e,this.showHideWatermark(!1),this.disposer=this.editor.addDomEventHandler({focus:this.handleWatermark,blur:this.handleWatermark})},e.prototype.dispose=function(){this.disposer(),this.disposer=null,this.hideWatermark(),this.editor=null},e.prototype.onPluginEvent=function(e){6==e.eventType?this.showHideWatermark("SetContent"==e.source):7==e.eventType&&this.isWatermarkShowing&&this.removeWartermarkFromHtml(e)},e.prototype.showHideWatermark=function(e){this.editor.hasFocus()&&(e||this.isWatermarkShowing)?(this.hideWatermark(),this.editor.focus()):this.editor.hasFocus()||!e&&this.isWatermarkShowing||!this.editor.isEmpty(!0)||this.showWatermark()},e.prototype.showWatermark=function(){var e=this.editor.getDocument(),t=r.wrap(e.createTextNode(this.watermark),'<span id="_rooster_watermarkSpan"></span>');r.applyFormat(t,this.format,this.editor.isDarkMode()),this.editor.insertNode(t,{position:0,updateCursor:!1,replaceSelection:!1,insertOnNewLine:!1}),this.isWatermarkShowing=!0},e.prototype.hideWatermark=function(){var e=this;this.editor.queryElements('span[id="_rooster_watermarkSpan"]',function(t){var n=t.parentNode;e.editor.deleteNode(t),e.editor.contains(n)&&"DIV"==r.getTagOfNode(n)&&!n.firstChild&&n.appendChild(e.editor.getDocument().createElement("BR"))}),this.isWatermarkShowing=!1},e.prototype.removeWartermarkFromHtml=function(e){var t=e.content;t=t.replace(i,""),e.content=t},e}();t.default=o},5249:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3458),i=function(){function e(){var e=this;this.pageX=-1,this.onMouseOver=function(t){var n=t.srcElement||t.target;e.pageX<0&&n&&("TD"==n.tagName||"TH"==n.tagName)&&n!=e.td&&(e.td=n,e.calcAndShowHandle())},this.onMouseDown=function(t){e.editor&&!e.editor.isDisposed()&&(e.pageX=t.pageX,e.initialPageX=t.pageX,e.attachMouseEvents(),e.getResizeHandle().style.borderWidth="0 1px",e.cancelEvent(t))},this.onMouseMove=function(t){e.adjustHandle(t.pageX),e.cancelEvent(t)},this.onMouseUp=function(t){e.detachMouseEvents(),e.getResizeHandle().style.borderWidth="0";var n=e.editor.getElementAtCursor("TABLE",e.td),r=parseInt(n.cellPadding);if(r=isNaN(r)?0:r,t.pageX!=e.initialPageX){var i=e.td.clientWidth-2*r+(t.pageX-e.initialPageX)*(e.isRtl(n)?-1:1);e.editor.addUndoSnapshot(function(t,n){e.setTableColumnWidth(i+"px"),e.editor.select(t,n)},"Format")}e.pageX=-1,e.calcAndShowHandle(),e.editor.focus(),e.cancelEvent(t)}}return e.prototype.initialize=function(e){this.editor=e,this.onMouseOverDisposer=this.editor.addDomEventHandler("mouseover",this.onMouseOver)},e.prototype.getName=function(){return"TableResize"},e.prototype.dispose=function(){this.detachMouseEvents(),this.editor=null,this.onMouseOverDisposer()},e.prototype.onPluginEvent=function(e){this.td&&(0==e.eventType||6==e.eventType||4==e.eventType&&!this.clickIntoCurrentTd(e))&&(this.td=null,this.calcAndShowHandle())},e.prototype.clickIntoCurrentTd=function(e){var t=e.rawEvent.target;return t instanceof Node&&r.contains(this.td,t,!0)},e.prototype.calcAndShowHandle=function(){if(this.td){var e=this.editor.getElementAtCursor("TR",this.td),t=this.editor.getElementAtCursor("TABLE",e);if(e&&t){var n=this.getPosition(t),r=n[0],i=n[1],o=this.getResizeHandle();r+=this.td.offsetLeft+(this.isRtl(t)?0:this.td.offsetWidth-6),o.style.display="",o.style.top=i+"px",o.style.height=t.offsetHeight+"px",o.style.left=r+"px"}}else this.getResizeHandle().style.display="none"},e.prototype.adjustHandle=function(e){var t=this.getResizeHandle();t.style.left=t.offsetLeft+e-this.pageX+"px",this.pageX=e},e.prototype.getPosition=function(e){var t=e.offsetParent,n=t?this.getPosition(t):[0,0],r=n[0],i=n[1];return[r+e.offsetLeft-e.scrollLeft,i+e.offsetTop-e.scrollTop]},e.prototype.getResizeHandle=function(){var e=this;return this.editor.getCustomData("TABLE_RESIZE_HANDLE",function(){var t=e.editor.getDocument(),n=r.fromHtml('<div style="position: fixed; cursor: col-resize; width: 6px; border: solid 0 #C6C6C6;"></div>',t)[0];return e.editor.insertNode(n,{position:4,updateCursor:!1,replaceSelection:!1,insertOnNewLine:!1}),n.addEventListener("mousedown",e.onMouseDown),n},function(t){t.removeEventListener("mousedown",e.onMouseDown),t.parentNode.removeChild(t)})},e.prototype.cancelEvent=function(e){e.stopPropagation(),e.preventDefault()},e.prototype.attachMouseEvents=function(){if(this.editor&&!this.editor.isDisposed()){var e=this.editor.getDocument();e.addEventListener("mousemove",this.onMouseMove,!0),e.addEventListener("mouseup",this.onMouseUp,!0)}},e.prototype.detachMouseEvents=function(){if(this.editor&&!this.editor.isDisposed()){var e=this.editor.getDocument();e.removeEventListener("mousemove",this.onMouseMove,!0),e.removeEventListener("mouseup",this.onMouseUp,!0)}},e.prototype.setTableColumnWidth=function(e){var t=this,n=new r.VTable(this.td);return n.table.style.width="",n.table.width="",n.forEachCellOfCurrentColumn(function(n){n.td&&(n.td.style.width=n.td==t.td?e:"")}),n.writeBack(),this.editor.contains(this.td)?this.td:n.getCurrentTd()},e.prototype.isRtl=function(e){return"rtl"==r.getComputedStyle(e,"direction")},e}();t.default=i},5250:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3568),i=function(e,t,n){return{sourceString:e,replacementHTML:t,matchSourceCaseSensitive:n}},o=[i(":)","ðŸ™‚",!0),i(";)","ðŸ˜‰",!0),i(":O","ðŸ˜²",!0),i(":o","ðŸ˜¯",!0),i("<3","â¤ï¸",!0)],s=function(){function e(e){void 0===e&&(e=o),this.updateReplacements(e)}return e.prototype.updateReplacements=function(e){var t;this.replacements=e,this.longestReplacementLength=(t=this.replacements,Math.max.apply(null,t.map(function(e){return e.sourceString.length}))),this.replacementEndCharacters=function(e){for(var t=new Set,n=0,r=e;n<r.length;n++){var i=r[n],o=i.sourceString;if(0!=o.length){var s=o[o.length-1];i.matchSourceCaseSensitive?t.add(s):(t.add(s.toLocaleLowerCase()),t.add(s.toLocaleUpperCase()))}}return t}(this.replacements)},e.prototype.getName=function(){return"CustomReplace"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){var t=this;if(!this.editor.isInIME()&&11==e.eventType&&((!e.rawEvent.data||this.replacementEndCharacters.has(e.rawEvent.data))&&null!=this.editor.getSelectionRange())){var n=r.cacheGetContentSearcher(e,this.editor),i=n.getSubStringBefore(this.longestReplacementLength),o=this.getMatchingReplacement(i);if(null!=o){var s=n.getSubStringBefore(o.sourceString.length),a=n.getRangeFromText(s,!0),l=document.createElement("span");l.innerHTML=o.replacementHTML;var u=1==l.childNodes.length?l.childNodes[0]:l;this.editor.performAutoComplete(function(){a.deleteContents(),a.insertNode(u),t.editor.select(u,-1)})}}},e.prototype.getMatchingReplacement=function(e){if(0==e.length)return null;for(var t=e.toLocaleLowerCase(),n=0,r=this.replacements;n<r.length;n++){var i=r[n],o=i.matchSourceCaseSensitive?[e,i.sourceString]:[t,i.sourceString.toLocaleLowerCase()],s=o[0],a=o[1];if(s.substring(s.length-a.length)==a)return i}return null},e}();t.default=s},7852:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(56),i=n(7853);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("SetMailboxAutoReplyConfiguration",e,t)}},7853:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"SetMailboxAutoReplyConfigurationRequest:#Exchange"},e)}}}]);
//# sourceMappingURL=owa.vendors~QuickComposeContents.js.map
self.scriptsLoaded['owa.vendors~QuickComposeContents.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.vendors~QuickComposeContents.js'] = (new Date()).getTime();